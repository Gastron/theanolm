/l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab
THEANO_FLAGS=floatX=float32,device=cuda0
Reading vocabulary from /l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab.
Computing unigram probabilities for out-of-shortlist words.
Number of words in vocabulary: 10001
Number of words in shortlist: 10001
Number of word classes: 10001
2017-08-03 14:42:29,897 train: TRAINING OPTIONS
2017-08-03 14:42:29,897 train: max_annealing_count: 0
2017-08-03 14:42:29,897 train: max_epochs: 15
2017-08-03 14:42:29,897 train: patience: 0
2017-08-03 14:42:29,897 train: validation_frequency: 1
2017-08-03 14:42:29,897 train: batch_size: 24
2017-08-03 14:42:29,897 train: min_epochs: 1
2017-08-03 14:42:29,897 train: sequence_length: 25
2017-08-03 14:42:29,897 train: stopping_criterion: no-improvement
2017-08-03 14:42:29,897 train: OPTIMIZATION OPTIONS
2017-08-03 14:42:29,897 train: noise_sharing: None
2017-08-03 14:42:29,897 train: epsilon: 1e-06
2017-08-03 14:42:29,898 train: weights: [ 1.]
2017-08-03 14:42:29,898 train: sqr_gradient_decay_rate: 0.999
2017-08-03 14:42:29,898 train: num_noise_samples: 25
2017-08-03 14:42:29,898 train: learning_rate: 20.0
2017-08-03 14:42:29,898 train: momentum: 0.9
2017-08-03 14:42:29,898 train: method: sgd
2017-08-03 14:42:29,898 train: max_gradient_norm: 5.0
2017-08-03 14:42:29,898 train: gradient_decay_rate: 0.9
Creating trainer.
Computing the number of mini-batches in training data.
2017-08-03 14:42:31,308 __init__: One epoch of training data contains 2371 mini-batch updates.
2017-08-03 14:42:31,309 __init__: Class unigram log probabilities are in the range [-13.786758, -2.951697].
2017-08-03 14:42:31,310 __init__: Finding sentence start positions in /teamwork/t40511_asr/c/penn-treebank-project/ptb.train.txt.
2017-08-03 14:42:31,329 _reset: Generating a random order of input lines.
Building neural network.
2017-08-03 14:42:31,337 __init__: Creating layers.
2017-08-03 14:42:31,337 __init__: - NetworkInput name=word_input inputs=[] size=10001 depth=1 devices=[]
2017-08-03 14:42:31,337 __init__: - ProjectionLayer name=projection_layer inputs=[word_input] size=100 depth=1 devices=[None]
2017-08-03 14:42:31,415 add:      * layers/projection_layer/W size=1000100 type=float32 device=None
2017-08-03 14:42:31,415 __init__: - LSTMLayer name=hidden_layer inputs=[projection_layer] size=256 depth=1 devices=[None]
2017-08-03 14:42:31,423 add:      * layers/hidden_layer/layer_input/W size=102400 type=float32 device=None
2017-08-03 14:42:31,661 add:      * layers/hidden_layer/step_input/W size=262144 type=float32 device=None
2017-08-03 14:42:31,661 add:      * layers/hidden_layer/layer_input/b size=1024 type=float32 device=None
2017-08-03 14:42:31,661 __init__: - SoftmaxLayer name=output_layer inputs=[hidden_layer] size=10001 depth=1 devices=[None]
2017-08-03 14:42:31,880 add:      * layers/output_layer/input/W size=2560256 type=float32 device=None
2017-08-03 14:42:31,880 add:      * layers/output_layer/input/b size=10001 type=float32 device=None
2017-08-03 14:42:31,880 __init__: Total number of parameters: 3935925
An unexpected TypeError exception occurred. Traceback will be written to debug log. The error message was: __init__() missing 1 required positional argument: 'support'
2017-08-03 14:42:31,922 exception_handler: Traceback:
2017-08-03 14:42:31,922 exception_handler: File "/u/42/senarvi/unix/git/theanolm/bin/theanolm", line 140, in <module>
    main()
2017-08-03 14:42:31,922 exception_handler: File "/u/42/senarvi/unix/git/theanolm/bin/theanolm", line 86, in main
    args.command_function(args)
2017-08-03 14:42:31,922 exception_handler: File "/u/42/senarvi/unix/git/theanolm/theanolm/commands/train.py", line 392, in train
    args.noise_sharing)
2017-08-03 14:42:31,922 exception_handler: File "/u/42/senarvi/unix/git/theanolm/theanolm/network/network.py", line 315, in set_sampling
    distribution = LogUniformDistribution(self.random)
Computing evaluation set perplexity.
Reading vocabulary from network state.
Number of words in vocabulary: 10001
Number of words in shortlist: 10001
Number of word classes: 10001
Building neural network.
The neural network state that you tried to load is invalid. It may have been created with an old version of TheanoLM, or the file may be corrupt. The error message was: Architecture is missing from neural network state.
