/l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab
THEANO_FLAGS=floatX=float32,device=cuda0
Reading vocabulary from /l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab.
Computing unigram probabilities for out-of-shortlist words.
Number of words in vocabulary: 10001
Number of words in shortlist: 10001
Number of word classes: 10001
2017-08-03 01:52:25,769 train: TRAINING OPTIONS
2017-08-03 01:52:25,769 train: stopping_criterion: no-improvement
2017-08-03 01:52:25,769 train: validation_frequency: 1
2017-08-03 01:52:25,769 train: patience: 0
2017-08-03 01:52:25,769 train: max_epochs: 15
2017-08-03 01:52:25,769 train: batch_size: 24
2017-08-03 01:52:25,769 train: max_annealing_count: 0
2017-08-03 01:52:25,769 train: sequence_length: 25
2017-08-03 01:52:25,769 train: min_epochs: 1
2017-08-03 01:52:25,770 train: OPTIMIZATION OPTIONS
2017-08-03 01:52:25,770 train: epsilon: 1e-06
2017-08-03 01:52:25,770 train: max_gradient_norm: 5.0
2017-08-03 01:52:25,770 train: method: sgd
2017-08-03 01:52:25,770 train: sqr_gradient_decay_rate: 0.999
2017-08-03 01:52:25,770 train: gradient_decay_rate: 0.9
2017-08-03 01:52:25,770 train: noise_sharing: None
2017-08-03 01:52:25,770 train: learning_rate: 20.0
2017-08-03 01:52:25,770 train: momentum: 0.9
2017-08-03 01:52:25,770 train: weights: [ 1.]
2017-08-03 01:52:25,770 train: num_noise_samples: 25
Creating trainer.
Computing the number of mini-batches in training data.
2017-08-03 01:52:27,069 __init__: One epoch of training data contains 2371 mini-batch updates.
2017-08-03 01:52:27,070 __init__: Class unigram log probabilities are in the range [-13.786758, -2.951697].
2017-08-03 01:52:27,070 __init__: Finding sentence start positions in /teamwork/t40511_asr/c/penn-treebank-project/ptb.train.txt.
2017-08-03 01:52:27,090 _reset: Generating a random order of input lines.
Building neural network.
2017-08-03 01:52:27,097 __init__: Creating layers.
2017-08-03 01:52:27,097 __init__: - NetworkInput name=word_input inputs=[] size=10001 depth=1 devices=[]
2017-08-03 01:52:27,097 __init__: - ProjectionLayer name=projection_layer inputs=[word_input] size=100 depth=1 devices=[None]
2017-08-03 01:52:27,175 add:      * layers/projection_layer/W size=1000100 type=float32 device=None
2017-08-03 01:52:27,175 __init__: - LSTMLayer name=hidden_layer inputs=[projection_layer] size=256 depth=1 devices=[None]
2017-08-03 01:52:27,183 add:      * layers/hidden_layer/layer_input/W size=102400 type=float32 device=None
2017-08-03 01:52:27,443 add:      * layers/hidden_layer/step_input/W size=262144 type=float32 device=None
2017-08-03 01:52:27,443 add:      * layers/hidden_layer/layer_input/b size=1024 type=float32 device=None
2017-08-03 01:52:27,443 __init__: - SoftmaxLayer name=output_layer inputs=[hidden_layer] size=10001 depth=1 devices=[None]
2017-08-03 01:52:27,662 add:      * layers/output_layer/input/W size=2560256 type=float32 device=None
2017-08-03 01:52:27,662 add:      * layers/output_layer/input/b size=10001 type=float32 device=None
2017-08-03 01:52:27,662 __init__: Total number of parameters: 3935925
Building optimizer.
2017-08-03 01:52:28,658 add:      * layers/hidden_layer/step_input/W_gradient size=262144 type=float32 device=None
2017-08-03 01:52:28,663 add:      * layers/output_layer/input/W_gradient size=2560256 type=float32 device=None
2017-08-03 01:52:28,665 add:      * layers/projection_layer/W_gradient size=1000100 type=float32 device=None
2017-08-03 01:52:28,666 add:      * layers/hidden_layer/layer_input/W_gradient size=102400 type=float32 device=None
2017-08-03 01:52:28,666 add:      * layers/hidden_layer/layer_input/b_gradient size=1024 type=float32 device=None
2017-08-03 01:52:28,666 add:      * layers/output_layer/input/b_gradient size=10001 type=float32 device=None
Building text scorer for cross-validation.
Validation text: /teamwork/t40511_asr/c/penn-treebank-project/ptb.valid.txt
Training neural network.
2017-08-03 01:54:55,549 _log_update: [200] (8.4 %) of epoch 1 -- lr = 2e+01, duration = 32.1 ms
2017-08-03 01:55:59,493 _log_update: [400] (16.9 %) of epoch 1 -- lr = 2e+01, duration = 31.8 ms
2017-08-03 01:57:03,488 _log_update: [600] (25.3 %) of epoch 1 -- lr = 2e+01, duration = 32.3 ms
2017-08-03 01:58:07,419 _log_update: [800] (33.7 %) of epoch 1 -- lr = 2e+01, duration = 31.9 ms
2017-08-03 01:59:11,399 _log_update: [1000] (42.2 %) of epoch 1 -- lr = 2e+01, duration = 31.8 ms
2017-08-03 02:00:15,370 _log_update: [1200] (50.6 %) of epoch 1 -- lr = 2e+01, duration = 32.0 ms
2017-08-03 02:01:19,368 _log_update: [1400] (59.0 %) of epoch 1 -- lr = 2e+01, duration = 31.9 ms
2017-08-03 02:02:23,444 _log_update: [1600] (67.5 %) of epoch 1 -- lr = 2e+01, duration = 31.9 ms
2017-08-03 02:03:27,427 _log_update: [1800] (75.9 %) of epoch 1 -- lr = 2e+01, duration = 32.1 ms
2017-08-03 02:04:31,425 _log_update: [2000] (84.4 %) of epoch 1 -- lr = 2e+01, duration = 31.8 ms
2017-08-03 02:05:35,422 _log_update: [2200] (92.8 %) of epoch 1 -- lr = 2e+01, duration = 32.0 ms
2017-08-03 02:06:32,051 _validate: [2365] First validation sample, perplexity 309.54.
2017-08-03 02:06:44,529 _validate: [2368] Center of validation, perplexity 333.46.
2017-08-03 02:06:57,084 _validate: [2371] Last validation sample, perplexity 444.75.
2017-08-03 02:06:57,106 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-03 02:06:57,106 _log_validation: [2371] Validation set cost history: [355.2]
2017-08-03 02:06:57,107 _reset: Generating a random order of input lines.
Finished training epoch 1 in 0 hours 13.1 minutes. Best validation perplexity 355.23.
2017-08-03 02:07:06,388 _log_update: [29] (1.2 %) of epoch 2 -- lr = 2e+01, duration = 31.8 ms
2017-08-03 02:08:10,372 _log_update: [229] (9.7 %) of epoch 2 -- lr = 2e+01, duration = 31.8 ms
2017-08-03 02:09:14,350 _log_update: [429] (18.1 %) of epoch 2 -- lr = 2e+01, duration = 32.0 ms
2017-08-03 02:10:18,352 _log_update: [629] (26.5 %) of epoch 2 -- lr = 2e+01, duration = 32.2 ms
2017-08-03 02:11:22,350 _log_update: [829] (35.0 %) of epoch 2 -- lr = 2e+01, duration = 32.0 ms
2017-08-03 02:12:26,342 _log_update: [1029] (43.4 %) of epoch 2 -- lr = 2e+01, duration = 31.8 ms
2017-08-03 02:13:30,348 _log_update: [1229] (51.8 %) of epoch 2 -- lr = 2e+01, duration = 32.2 ms
2017-08-03 02:14:34,296 _log_update: [1429] (60.3 %) of epoch 2 -- lr = 2e+01, duration = 32.1 ms
2017-08-03 02:15:38,293 _log_update: [1629] (68.7 %) of epoch 2 -- lr = 2e+01, duration = 31.9 ms
2017-08-03 02:16:42,293 _log_update: [1829] (77.1 %) of epoch 2 -- lr = 2e+01, duration = 32.3 ms
2017-08-03 02:17:46,265 _log_update: [2029] (85.6 %) of epoch 2 -- lr = 2e+01, duration = 32.2 ms
2017-08-03 02:18:50,291 _log_update: [2229] (94.0 %) of epoch 2 -- lr = 2e+01, duration = 32.2 ms
2017-08-03 02:19:37,686 _validate: [2365] First validation sample, perplexity 245.60.
2017-08-03 02:19:50,168 _validate: [2368] Center of validation, perplexity 260.20.
2017-08-03 02:20:02,692 _validate: [2371] Last validation sample, perplexity 268.18.
2017-08-03 02:20:02,711 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-03 02:20:02,711 _log_validation: [2371] Validation set cost history: 355.2 [260.2]
2017-08-03 02:20:02,712 _reset: Generating a random order of input lines.
Finished training epoch 2 in 0 hours 13.1 minutes. Best validation perplexity 260.20.
2017-08-03 02:20:21,255 _log_update: [58] (2.4 %) of epoch 3 -- lr = 2e+01, duration = 31.9 ms
2017-08-03 02:21:25,231 _log_update: [258] (10.9 %) of epoch 3 -- lr = 2e+01, duration = 31.9 ms
2017-08-03 02:22:29,204 _log_update: [458] (19.3 %) of epoch 3 -- lr = 2e+01, duration = 31.8 ms
2017-08-03 02:23:33,183 _log_update: [658] (27.8 %) of epoch 3 -- lr = 2e+01, duration = 32.1 ms
2017-08-03 02:24:37,159 _log_update: [858] (36.2 %) of epoch 3 -- lr = 2e+01, duration = 31.8 ms
2017-08-03 02:25:41,151 _log_update: [1058] (44.6 %) of epoch 3 -- lr = 2e+01, duration = 31.7 ms
2017-08-03 02:26:45,105 _log_update: [1258] (53.1 %) of epoch 3 -- lr = 2e+01, duration = 31.7 ms
2017-08-03 02:27:49,082 _log_update: [1458] (61.5 %) of epoch 3 -- lr = 2e+01, duration = 32.0 ms
2017-08-03 02:28:53,040 _log_update: [1658] (69.9 %) of epoch 3 -- lr = 2e+01, duration = 32.2 ms
2017-08-03 02:29:57,032 _log_update: [1858] (78.4 %) of epoch 3 -- lr = 2e+01, duration = 31.7 ms
2017-08-03 02:31:01,027 _log_update: [2058] (86.8 %) of epoch 3 -- lr = 2e+01, duration = 31.8 ms
2017-08-03 02:32:05,023 _log_update: [2258] (95.2 %) of epoch 3 -- lr = 2e+01, duration = 31.9 ms
2017-08-03 02:32:43,142 _validate: [2365] First validation sample, perplexity 221.84.
2017-08-03 02:32:55,612 _validate: [2368] Center of validation, perplexity 220.59.
2017-08-03 02:33:08,104 _validate: [2371] Last validation sample, perplexity 284.04.
2017-08-03 02:33:08,122 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-03 02:33:08,122 _log_validation: [2371] Validation set cost history: 355.2 260.2 [238.5]
2017-08-03 02:33:08,122 _reset: Generating a random order of input lines.
Finished training epoch 3 in 0 hours 13.1 minutes. Best validation perplexity 238.46.
2017-08-03 02:33:35,929 _log_update: [87] (3.7 %) of epoch 4 -- lr = 2e+01, duration = 31.9 ms
2017-08-03 02:34:39,909 _log_update: [287] (12.1 %) of epoch 4 -- lr = 2e+01, duration = 31.8 ms
2017-08-03 02:35:43,896 _log_update: [487] (20.5 %) of epoch 4 -- lr = 2e+01, duration = 31.9 ms
2017-08-03 02:36:47,845 _log_update: [687] (29.0 %) of epoch 4 -- lr = 2e+01, duration = 32.0 ms
2017-08-03 02:37:51,809 _log_update: [887] (37.4 %) of epoch 4 -- lr = 2e+01, duration = 31.8 ms
2017-08-03 02:38:55,775 _log_update: [1087] (45.8 %) of epoch 4 -- lr = 2e+01, duration = 31.7 ms
2017-08-03 02:39:59,710 _log_update: [1287] (54.3 %) of epoch 4 -- lr = 2e+01, duration = 31.6 ms
2017-08-03 02:41:03,660 _log_update: [1487] (62.7 %) of epoch 4 -- lr = 2e+01, duration = 31.8 ms
2017-08-03 02:42:07,602 _log_update: [1687] (71.2 %) of epoch 4 -- lr = 2e+01, duration = 31.8 ms
2017-08-03 02:43:11,588 _log_update: [1887] (79.6 %) of epoch 4 -- lr = 2e+01, duration = 31.8 ms
2017-08-03 02:44:15,565 _log_update: [2087] (88.0 %) of epoch 4 -- lr = 2e+01, duration = 32.0 ms
2017-08-03 02:45:19,559 _log_update: [2287] (96.5 %) of epoch 4 -- lr = 2e+01, duration = 31.9 ms
2017-08-03 02:45:48,362 _validate: [2365] First validation sample, perplexity 293.36.
2017-08-03 02:46:00,850 _validate: [2368] Center of validation, perplexity 206.47.
2017-08-03 02:46:13,347 _validate: [2371] Last validation sample, perplexity 246.69.
2017-08-03 02:46:13,365 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-03 02:46:13,365 _log_validation: [2371] Validation set cost history: 355.2 260.2 238.5 [210.7]
2017-08-03 02:46:13,366 _reset: Generating a random order of input lines.
Finished training epoch 4 in 0 hours 13.1 minutes. Best validation perplexity 210.68.
2017-08-03 02:46:50,589 _log_update: [116] (4.9 %) of epoch 5 -- lr = 2e+01, duration = 32.1 ms
2017-08-03 02:47:54,792 _log_update: [316] (13.3 %) of epoch 5 -- lr = 2e+01, duration = 32.0 ms
2017-08-03 02:48:59,007 _log_update: [516] (21.8 %) of epoch 5 -- lr = 2e+01, duration = 32.0 ms
2017-08-03 02:50:03,235 _log_update: [716] (30.2 %) of epoch 5 -- lr = 2e+01, duration = 31.8 ms
2017-08-03 02:51:07,419 _log_update: [916] (38.6 %) of epoch 5 -- lr = 2e+01, duration = 32.2 ms
2017-08-03 02:52:11,626 _log_update: [1116] (47.1 %) of epoch 5 -- lr = 2e+01, duration = 31.8 ms
2017-08-03 02:53:15,823 _log_update: [1316] (55.5 %) of epoch 5 -- lr = 2e+01, duration = 32.1 ms
2017-08-03 02:54:20,039 _log_update: [1516] (63.9 %) of epoch 5 -- lr = 2e+01, duration = 32.1 ms
2017-08-03 02:55:24,240 _log_update: [1716] (72.4 %) of epoch 5 -- lr = 2e+01, duration = 32.0 ms
2017-08-03 02:56:28,467 _log_update: [1916] (80.8 %) of epoch 5 -- lr = 2e+01, duration = 32.4 ms
2017-08-03 02:57:32,726 _log_update: [2116] (89.2 %) of epoch 5 -- lr = 2e+01, duration = 32.2 ms
2017-08-03 02:58:36,958 _log_update: [2316] (97.7 %) of epoch 5 -- lr = 2e+01, duration = 31.9 ms
2017-08-03 02:58:56,542 _validate: [2365] First validation sample, perplexity 191.80.
2017-08-03 02:59:09,022 _validate: [2368] Center of validation, perplexity 193.19.
2017-08-03 02:59:21,516 _validate: [2371] Last validation sample, perplexity 223.49.
2017-08-03 02:59:21,533 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-03 02:59:21,533 _log_validation: [2371] Validation set cost history: 355.2 260.2 238.5 210.7 [194.7]
2017-08-03 02:59:21,534 _reset: Generating a random order of input lines.
Finished training epoch 5 in 0 hours 13.1 minutes. Best validation perplexity 194.68.
2017-08-03 03:00:07,890 _log_update: [145] (6.1 %) of epoch 6 -- lr = 2e+01, duration = 32.0 ms
2017-08-03 03:01:11,856 _log_update: [345] (14.6 %) of epoch 6 -- lr = 2e+01, duration = 32.0 ms
2017-08-03 03:02:15,847 _log_update: [545] (23.0 %) of epoch 6 -- lr = 2e+01, duration = 31.9 ms
2017-08-03 03:03:19,800 _log_update: [745] (31.4 %) of epoch 6 -- lr = 2e+01, duration = 31.7 ms
2017-08-03 03:04:23,767 _log_update: [945] (39.9 %) of epoch 6 -- lr = 2e+01, duration = 31.9 ms
2017-08-03 03:05:27,728 _log_update: [1145] (48.3 %) of epoch 6 -- lr = 2e+01, duration = 32.2 ms
2017-08-03 03:06:31,707 _log_update: [1345] (56.7 %) of epoch 6 -- lr = 2e+01, duration = 31.7 ms
2017-08-03 03:07:35,671 _log_update: [1545] (65.2 %) of epoch 6 -- lr = 2e+01, duration = 31.9 ms
2017-08-03 03:08:39,638 _log_update: [1745] (73.6 %) of epoch 6 -- lr = 2e+01, duration = 31.9 ms
2017-08-03 03:09:43,617 _log_update: [1945] (82.0 %) of epoch 6 -- lr = 2e+01, duration = 31.9 ms
2017-08-03 03:10:47,573 _log_update: [2145] (90.5 %) of epoch 6 -- lr = 2e+01, duration = 31.8 ms
2017-08-03 03:11:51,498 _log_update: [2345] (98.9 %) of epoch 6 -- lr = 2e+01, duration = 31.9 ms
2017-08-03 03:12:01,761 _validate: [2365] First validation sample, perplexity 201.71.
2017-08-03 03:12:14,246 _validate: [2368] Center of validation, perplexity 228.65.
2017-08-03 03:12:26,766 _validate: [2371] Last validation sample, perplexity 238.22.
2017-08-03 03:12:26,766 _log_validation: [2371] Validation set cost history: 355.2 260.2 238.5 210.7 [194.7] 205.6
2017-08-03 03:12:26,768 set_state: layers/projection_layer/W <- array(10001, 100)
2017-08-03 03:12:26,768 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-08-03 03:12:26,769 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-08-03 03:12:26,769 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-08-03 03:12:26,769 set_state: layers/output_layer/input/b <- array(10001,)
2017-08-03 03:12:26,772 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-08-03 03:12:26,774 _reset_state: [2368] (99.87 %) of epoch 5
2017-08-03 03:12:26,774 _log_validation: [2368] Validation set cost history: 355.2 260.2 238.5 210.7 [194.7]
2017-08-03 03:12:26,775 set_state: Restored iterator to line 42026 of 42068.
2017-08-03 03:12:26,775 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2017-08-03 03:12:26,775 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2017-08-03 03:12:26,776 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2017-08-03 03:12:26,784 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2017-08-03 03:12:26,785 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2017-08-03 03:12:26,786 set_state: layers/output_layer/input/b_gradient <- array(10001,)
Model performance stopped improving. Decreasing learning rate from 20.0 to 10.0 and resetting state to 100 % of epoch 5.
2017-08-03 03:12:26,787 _reset: Generating a random order of input lines.
Finished training epoch 5 in 0 hours 13.1 minutes. Best validation perplexity 194.68.
2017-08-03 03:13:22,420 _log_update: [174] (7.3 %) of epoch 6 -- lr = 1e+01, duration = 31.8 ms
2017-08-03 03:14:26,408 _log_update: [374] (15.8 %) of epoch 6 -- lr = 1e+01, duration = 31.7 ms
2017-08-03 03:15:30,358 _log_update: [574] (24.2 %) of epoch 6 -- lr = 1e+01, duration = 31.8 ms
2017-08-03 03:16:34,337 _log_update: [774] (32.6 %) of epoch 6 -- lr = 1e+01, duration = 31.8 ms
2017-08-03 03:17:38,335 _log_update: [974] (41.1 %) of epoch 6 -- lr = 1e+01, duration = 31.7 ms
2017-08-03 03:18:42,317 _log_update: [1174] (49.5 %) of epoch 6 -- lr = 1e+01, duration = 31.8 ms
2017-08-03 03:19:46,313 _log_update: [1374] (58.0 %) of epoch 6 -- lr = 1e+01, duration = 31.8 ms
2017-08-03 03:20:50,287 _log_update: [1574] (66.4 %) of epoch 6 -- lr = 1e+01, duration = 31.6 ms
2017-08-03 03:21:54,308 _log_update: [1774] (74.8 %) of epoch 6 -- lr = 1e+01, duration = 31.8 ms
2017-08-03 03:22:58,287 _log_update: [1974] (83.3 %) of epoch 6 -- lr = 1e+01, duration = 31.9 ms
2017-08-03 03:24:02,305 _log_update: [2174] (91.7 %) of epoch 6 -- lr = 1e+01, duration = 31.9 ms
2017-08-03 03:25:07,298 _validate: [2365] First validation sample, perplexity 176.19.
2017-08-03 03:25:19,800 _validate: [2368] Center of validation, perplexity 172.64.
2017-08-03 03:25:32,289 _validate: [2371] Last validation sample, perplexity 175.39.
2017-08-03 03:25:32,306 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-03 03:25:32,306 _log_validation: [2371] Validation set cost history: 355.2 260.2 238.5 210.7 194.7 [175.4]
2017-08-03 03:25:32,307 _reset: Generating a random order of input lines.
Finished training epoch 6 in 0 hours 13.1 minutes. Best validation perplexity 175.39.
2017-08-03 03:25:33,252 _log_update: [3] (0.1 %) of epoch 7 -- lr = 1e+01, duration = 31.7 ms
2017-08-03 03:26:37,234 _log_update: [203] (8.6 %) of epoch 7 -- lr = 1e+01, duration = 32.0 ms
2017-08-03 03:27:41,146 _log_update: [403] (17.0 %) of epoch 7 -- lr = 1e+01, duration = 32.4 ms
2017-08-03 03:28:45,133 _log_update: [603] (25.4 %) of epoch 7 -- lr = 1e+01, duration = 32.0 ms
2017-08-03 03:29:49,105 _log_update: [803] (33.9 %) of epoch 7 -- lr = 1e+01, duration = 31.9 ms
2017-08-03 03:30:53,037 _log_update: [1003] (42.3 %) of epoch 7 -- lr = 1e+01, duration = 31.8 ms
2017-08-03 03:31:56,980 _log_update: [1203] (50.7 %) of epoch 7 -- lr = 1e+01, duration = 31.7 ms
2017-08-03 03:33:00,955 _log_update: [1403] (59.2 %) of epoch 7 -- lr = 1e+01, duration = 31.9 ms
2017-08-03 03:34:04,937 _log_update: [1603] (67.6 %) of epoch 7 -- lr = 1e+01, duration = 31.9 ms
2017-08-03 03:35:08,920 _log_update: [1803] (76.0 %) of epoch 7 -- lr = 1e+01, duration = 32.0 ms
2017-08-03 03:36:12,874 _log_update: [2003] (84.5 %) of epoch 7 -- lr = 1e+01, duration = 32.1 ms
2017-08-03 03:37:16,831 _log_update: [2203] (92.9 %) of epoch 7 -- lr = 1e+01, duration = 32.0 ms
2017-08-03 03:38:12,525 _validate: [2365] First validation sample, perplexity 174.75.
2017-08-03 03:38:24,995 _validate: [2368] Center of validation, perplexity 172.21.
2017-08-03 03:38:37,475 _validate: [2371] Last validation sample, perplexity 175.60.
2017-08-03 03:38:37,476 _log_validation: [2371] Validation set cost history: 355.2 260.2 238.5 210.7 194.7 [175.4] 175.6
2017-08-03 03:38:37,477 set_state: layers/projection_layer/W <- array(10001, 100)
2017-08-03 03:38:37,478 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-08-03 03:38:37,478 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-08-03 03:38:37,479 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-08-03 03:38:37,479 set_state: layers/output_layer/input/b <- array(10001,)
2017-08-03 03:38:37,482 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-08-03 03:38:37,483 _reset_state: [2368] (99.87 %) of epoch 6
2017-08-03 03:38:37,484 _log_validation: [2368] Validation set cost history: 355.2 260.2 238.5 210.7 194.7 [175.4]
2017-08-03 03:38:37,484 set_state: Restored iterator to line 42028 of 42068.
2017-08-03 03:38:37,484 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2017-08-03 03:38:37,485 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2017-08-03 03:38:37,486 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2017-08-03 03:38:37,493 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2017-08-03 03:38:37,495 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2017-08-03 03:38:37,495 set_state: layers/output_layer/input/b_gradient <- array(10001,)
Model performance stopped improving. Decreasing learning rate from 10.0 to 5.0 and resetting state to 100 % of epoch 6.
2017-08-03 03:38:37,496 _reset: Generating a random order of input lines.
Finished training epoch 6 in 0 hours 13.1 minutes. Best validation perplexity 175.39.
2017-08-03 03:38:47,722 _log_update: [32] (1.3 %) of epoch 7 -- lr = 5, duration = 31.9 ms
2017-08-03 03:39:51,691 _log_update: [232] (9.8 %) of epoch 7 -- lr = 5, duration = 31.9 ms
2017-08-03 03:40:55,655 _log_update: [432] (18.2 %) of epoch 7 -- lr = 5, duration = 31.9 ms
2017-08-03 03:41:59,621 _log_update: [632] (26.7 %) of epoch 7 -- lr = 5, duration = 31.9 ms
2017-08-03 03:43:03,575 _log_update: [832] (35.1 %) of epoch 7 -- lr = 5, duration = 31.8 ms
2017-08-03 03:44:07,574 _log_update: [1032] (43.5 %) of epoch 7 -- lr = 5, duration = 32.2 ms
2017-08-03 03:45:11,544 _log_update: [1232] (52.0 %) of epoch 7 -- lr = 5, duration = 31.8 ms
2017-08-03 03:46:15,488 _log_update: [1432] (60.4 %) of epoch 7 -- lr = 5, duration = 31.8 ms
2017-08-03 03:47:19,494 _log_update: [1632] (68.8 %) of epoch 7 -- lr = 5, duration = 32.0 ms
2017-08-03 03:48:23,467 _log_update: [1832] (77.3 %) of epoch 7 -- lr = 5, duration = 31.7 ms
2017-08-03 03:49:27,433 _log_update: [2032] (85.7 %) of epoch 7 -- lr = 5, duration = 31.9 ms
2017-08-03 03:50:31,409 _log_update: [2232] (94.1 %) of epoch 7 -- lr = 5, duration = 32.1 ms
2017-08-03 03:51:17,804 _validate: [2365] First validation sample, perplexity 165.15.
2017-08-03 03:51:30,314 _validate: [2368] Center of validation, perplexity 166.76.
2017-08-03 03:51:42,871 _validate: [2371] Last validation sample, perplexity 171.10.
2017-08-03 03:51:42,888 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-03 03:51:42,888 _log_validation: [2371] Validation set cost history: 355.2 260.2 238.5 210.7 194.7 175.4 [166.7]
2017-08-03 03:51:42,889 _reset: Generating a random order of input lines.
Finished training epoch 7 in 0 hours 13.1 minutes. Best validation perplexity 166.71.
2017-08-03 03:52:02,405 _log_update: [61] (2.6 %) of epoch 8 -- lr = 5, duration = 32.0 ms
2017-08-03 03:53:06,396 _log_update: [261] (11.0 %) of epoch 8 -- lr = 5, duration = 32.2 ms
2017-08-03 03:54:10,435 _log_update: [461] (19.4 %) of epoch 8 -- lr = 5, duration = 32.0 ms
2017-08-03 03:55:14,449 _log_update: [661] (27.9 %) of epoch 8 -- lr = 5, duration = 31.9 ms
2017-08-03 03:56:18,461 _log_update: [861] (36.3 %) of epoch 8 -- lr = 5, duration = 31.6 ms
2017-08-03 03:57:22,474 _log_update: [1061] (44.7 %) of epoch 8 -- lr = 5, duration = 31.7 ms
2017-08-03 03:58:26,448 _log_update: [1261] (53.2 %) of epoch 8 -- lr = 5, duration = 32.0 ms
2017-08-03 03:59:30,440 _log_update: [1461] (61.6 %) of epoch 8 -- lr = 5, duration = 31.9 ms
2017-08-03 04:00:34,442 _log_update: [1661] (70.1 %) of epoch 8 -- lr = 5, duration = 31.8 ms
2017-08-03 04:01:38,423 _log_update: [1861] (78.5 %) of epoch 8 -- lr = 5, duration = 31.9 ms
2017-08-03 04:02:42,445 _log_update: [2061] (86.9 %) of epoch 8 -- lr = 5, duration = 31.9 ms
2017-08-03 04:03:46,407 _log_update: [2261] (95.4 %) of epoch 8 -- lr = 5, duration = 32.0 ms
2017-08-03 04:04:23,520 _validate: [2365] First validation sample, perplexity 164.12.
2017-08-03 04:04:35,994 _validate: [2368] Center of validation, perplexity 164.46.
2017-08-03 04:04:48,490 _validate: [2371] Last validation sample, perplexity 166.08.
2017-08-03 04:04:48,507 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-03 04:04:48,507 _log_validation: [2371] Validation set cost history: 355.2 260.2 238.5 210.7 194.7 175.4 166.7 [166.1]
2017-08-03 04:04:48,508 _reset: Generating a random order of input lines.
Finished training epoch 8 in 0 hours 13.1 minutes. Best validation perplexity 166.08.
2017-08-03 04:05:17,276 _log_update: [90] (3.8 %) of epoch 9 -- lr = 5, duration = 31.9 ms
2017-08-03 04:06:21,247 _log_update: [290] (12.2 %) of epoch 9 -- lr = 5, duration = 31.7 ms
2017-08-03 04:07:25,221 _log_update: [490] (20.7 %) of epoch 9 -- lr = 5, duration = 31.9 ms
2017-08-03 04:08:29,212 _log_update: [690] (29.1 %) of epoch 9 -- lr = 5, duration = 31.8 ms
2017-08-03 04:09:33,220 _log_update: [890] (37.5 %) of epoch 9 -- lr = 5, duration = 31.9 ms
2017-08-03 04:10:37,205 _log_update: [1090] (46.0 %) of epoch 9 -- lr = 5, duration = 31.7 ms
2017-08-03 04:11:41,158 _log_update: [1290] (54.4 %) of epoch 9 -- lr = 5, duration = 32.0 ms
2017-08-03 04:12:45,122 _log_update: [1490] (62.8 %) of epoch 9 -- lr = 5, duration = 31.8 ms
2017-08-03 04:13:49,101 _log_update: [1690] (71.3 %) of epoch 9 -- lr = 5, duration = 32.1 ms
2017-08-03 04:14:53,056 _log_update: [1890] (79.7 %) of epoch 9 -- lr = 5, duration = 31.9 ms
2017-08-03 04:15:57,034 _log_update: [2090] (88.1 %) of epoch 9 -- lr = 5, duration = 31.9 ms
2017-08-03 04:17:01,012 _log_update: [2290] (96.6 %) of epoch 9 -- lr = 5, duration = 31.8 ms
2017-08-03 04:17:28,853 _validate: [2365] First validation sample, perplexity 167.11.
2017-08-03 04:17:41,326 _validate: [2368] Center of validation, perplexity 166.57.
2017-08-03 04:17:53,813 _validate: [2371] Last validation sample, perplexity 163.62.
2017-08-03 04:17:53,813 _log_validation: [2371] Validation set cost history: 355.2 260.2 238.5 210.7 194.7 175.4 166.7 [166.1] 166.6
2017-08-03 04:17:53,815 set_state: layers/projection_layer/W <- array(10001, 100)
2017-08-03 04:17:53,815 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-08-03 04:17:53,816 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-08-03 04:17:53,816 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-08-03 04:17:53,817 set_state: layers/output_layer/input/b <- array(10001,)
2017-08-03 04:17:53,820 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-08-03 04:17:53,821 _reset_state: [2368] (99.87 %) of epoch 8
2017-08-03 04:17:53,821 _log_validation: [2368] Validation set cost history: 355.2 260.2 238.5 210.7 194.7 175.4 166.7 [166.1]
2017-08-03 04:17:53,822 set_state: Restored iterator to line 42024 of 42068.
2017-08-03 04:17:53,822 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2017-08-03 04:17:53,823 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2017-08-03 04:17:53,823 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2017-08-03 04:17:53,831 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2017-08-03 04:17:53,832 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2017-08-03 04:17:53,833 set_state: layers/output_layer/input/b_gradient <- array(10001,)
Model performance stopped improving. Decreasing learning rate from 5.0 to 2.5 and resetting state to 100 % of epoch 8.
2017-08-03 04:17:53,834 _reset: Generating a random order of input lines.
Finished training epoch 8 in 0 hours 13.1 minutes. Best validation perplexity 166.08.
2017-08-03 04:18:32,022 _log_update: [119] (5.0 %) of epoch 9 -- lr = 2, duration = 32.2 ms
2017-08-03 04:19:36,214 _log_update: [319] (13.5 %) of epoch 9 -- lr = 2, duration = 31.9 ms
2017-08-03 04:20:40,462 _log_update: [519] (21.9 %) of epoch 9 -- lr = 2, duration = 31.9 ms
2017-08-03 04:21:44,656 _log_update: [719] (30.3 %) of epoch 9 -- lr = 2, duration = 32.0 ms
2017-08-03 04:22:48,850 _log_update: [919] (38.8 %) of epoch 9 -- lr = 2, duration = 32.1 ms
2017-08-03 04:23:53,028 _log_update: [1119] (47.2 %) of epoch 9 -- lr = 2, duration = 31.7 ms
2017-08-03 04:24:57,268 _log_update: [1319] (55.6 %) of epoch 9 -- lr = 2, duration = 32.0 ms
2017-08-03 04:26:01,519 _log_update: [1519] (64.1 %) of epoch 9 -- lr = 2, duration = 32.0 ms
2017-08-03 04:27:05,725 _log_update: [1719] (72.5 %) of epoch 9 -- lr = 2, duration = 32.0 ms
2017-08-03 04:28:09,946 _log_update: [1919] (80.9 %) of epoch 9 -- lr = 2, duration = 32.0 ms
2017-08-03 04:29:14,144 _log_update: [2119] (89.4 %) of epoch 9 -- lr = 2, duration = 32.2 ms
2017-08-03 04:30:18,348 _log_update: [2319] (97.8 %) of epoch 9 -- lr = 2, duration = 32.1 ms
2017-08-03 04:30:36,959 _validate: [2365] First validation sample, perplexity 164.94.
2017-08-03 04:30:49,427 _validate: [2368] Center of validation, perplexity 164.30.
2017-08-03 04:31:01,921 _validate: [2371] Last validation sample, perplexity 162.58.
2017-08-03 04:31:01,938 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-03 04:31:01,938 _log_validation: [2371] Validation set cost history: 355.2 260.2 238.5 210.7 194.7 175.4 166.7 166.1 [163.8]
2017-08-03 04:31:01,939 _reset: Generating a random order of input lines.
Finished training epoch 9 in 0 hours 13.1 minutes. Best validation perplexity 163.79.
2017-08-03 04:31:49,259 _log_update: [148] (6.2 %) of epoch 10 -- lr = 2, duration = 31.9 ms
2017-08-03 04:32:53,261 _log_update: [348] (14.7 %) of epoch 10 -- lr = 2, duration = 31.8 ms
2017-08-03 04:33:57,217 _log_update: [548] (23.1 %) of epoch 10 -- lr = 2, duration = 31.8 ms
2017-08-03 04:35:01,195 _log_update: [748] (31.5 %) of epoch 10 -- lr = 2, duration = 32.1 ms
2017-08-03 04:36:05,179 _log_update: [948] (40.0 %) of epoch 10 -- lr = 2, duration = 31.9 ms
2017-08-03 04:37:09,153 _log_update: [1148] (48.4 %) of epoch 10 -- lr = 2, duration = 31.9 ms
2017-08-03 04:38:13,118 _log_update: [1348] (56.9 %) of epoch 10 -- lr = 2, duration = 32.0 ms
2017-08-03 04:39:17,085 _log_update: [1548] (65.3 %) of epoch 10 -- lr = 2, duration = 32.1 ms
2017-08-03 04:40:21,060 _log_update: [1748] (73.7 %) of epoch 10 -- lr = 2, duration = 32.0 ms
2017-08-03 04:41:25,019 _log_update: [1948] (82.2 %) of epoch 10 -- lr = 2, duration = 31.9 ms
2017-08-03 04:42:29,000 _log_update: [2148] (90.6 %) of epoch 10 -- lr = 2, duration = 31.9 ms
2017-08-03 04:43:32,968 _log_update: [2348] (99.0 %) of epoch 10 -- lr = 2, duration = 32.0 ms
2017-08-03 04:43:42,265 _validate: [2365] First validation sample, perplexity 162.64.
2017-08-03 04:43:54,750 _validate: [2368] Center of validation, perplexity 162.86.
2017-08-03 04:44:07,265 _validate: [2371] Last validation sample, perplexity 162.90.
2017-08-03 04:44:07,282 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-03 04:44:07,282 _log_validation: [2371] Validation set cost history: 355.2 260.2 238.5 210.7 194.7 175.4 166.7 166.1 163.8 [162.9]
2017-08-03 04:44:07,283 _reset: Generating a random order of input lines.
Finished training epoch 10 in 0 hours 13.1 minutes. Best validation perplexity 162.86.
2017-08-03 04:45:03,924 _log_update: [177] (7.5 %) of epoch 11 -- lr = 2, duration = 32.0 ms
2017-08-03 04:46:07,959 _log_update: [377] (15.9 %) of epoch 11 -- lr = 2, duration = 31.9 ms
2017-08-03 04:47:11,957 _log_update: [577] (24.3 %) of epoch 11 -- lr = 2, duration = 31.9 ms
2017-08-03 04:48:15,944 _log_update: [777] (32.8 %) of epoch 11 -- lr = 2, duration = 32.1 ms
2017-08-03 04:49:19,945 _log_update: [977] (41.2 %) of epoch 11 -- lr = 2, duration = 32.0 ms
2017-08-03 04:50:23,930 _log_update: [1177] (49.6 %) of epoch 11 -- lr = 2, duration = 31.7 ms
2017-08-03 04:51:27,917 _log_update: [1377] (58.1 %) of epoch 11 -- lr = 2, duration = 31.8 ms
2017-08-03 04:52:31,949 _log_update: [1577] (66.5 %) of epoch 11 -- lr = 2, duration = 32.4 ms
2017-08-03 04:53:35,953 _log_update: [1777] (74.9 %) of epoch 11 -- lr = 2, duration = 31.8 ms
2017-08-03 04:54:39,977 _log_update: [1977] (83.4 %) of epoch 11 -- lr = 2, duration = 31.8 ms
2017-08-03 04:55:43,969 _log_update: [2177] (91.8 %) of epoch 11 -- lr = 2, duration = 32.1 ms
2017-08-03 04:56:47,983 _validate: [2365] First validation sample, perplexity 162.19.
2017-08-03 04:57:00,472 _validate: [2368] Center of validation, perplexity 162.98.
2017-08-03 04:57:12,974 _validate: [2371] Last validation sample, perplexity 160.75.
2017-08-03 04:57:12,992 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-03 04:57:12,992 _log_validation: [2371] Validation set cost history: 355.2 260.2 238.5 210.7 194.7 175.4 166.7 166.1 163.8 162.9 [162.2]
2017-08-03 04:57:12,992 _reset: Generating a random order of input lines.
Finished training epoch 11 in 0 hours 13.1 minutes. Best validation perplexity 162.19.
2017-08-03 04:57:14,906 _log_update: [6] (0.3 %) of epoch 12 -- lr = 2, duration = 31.7 ms
2017-08-03 04:58:18,868 _log_update: [206] (8.7 %) of epoch 12 -- lr = 2, duration = 31.6 ms
2017-08-03 04:59:22,825 _log_update: [406] (17.1 %) of epoch 12 -- lr = 2, duration = 31.7 ms
2017-08-03 05:00:26,826 _log_update: [606] (25.6 %) of epoch 12 -- lr = 2, duration = 31.9 ms
2017-08-03 05:01:30,786 _log_update: [806] (34.0 %) of epoch 12 -- lr = 2, duration = 31.8 ms
2017-08-03 05:02:34,783 _log_update: [1006] (42.4 %) of epoch 12 -- lr = 2, duration = 31.9 ms
2017-08-03 05:03:38,749 _log_update: [1206] (50.9 %) of epoch 12 -- lr = 2, duration = 32.0 ms
2017-08-03 05:04:42,701 _log_update: [1406] (59.3 %) of epoch 12 -- lr = 2, duration = 31.9 ms
2017-08-03 05:05:46,675 _log_update: [1606] (67.7 %) of epoch 12 -- lr = 2, duration = 31.9 ms
2017-08-03 05:06:50,652 _log_update: [1806] (76.2 %) of epoch 12 -- lr = 2, duration = 32.1 ms
2017-08-03 05:07:54,623 _log_update: [2006] (84.6 %) of epoch 12 -- lr = 2, duration = 32.0 ms
2017-08-03 05:08:58,585 _log_update: [2206] (93.0 %) of epoch 12 -- lr = 2, duration = 31.8 ms
2017-08-03 05:09:53,333 _validate: [2365] First validation sample, perplexity 163.41.
2017-08-03 05:10:05,825 _validate: [2368] Center of validation, perplexity 160.93.
2017-08-03 05:10:18,354 _validate: [2371] Last validation sample, perplexity 162.04.
2017-08-03 05:10:18,371 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-03 05:10:18,371 _log_validation: [2371] Validation set cost history: 355.2 260.2 238.5 210.7 194.7 175.4 166.7 166.1 163.8 162.9 162.2 [161.7]
2017-08-03 05:10:18,372 _reset: Generating a random order of input lines.
Finished training epoch 12 in 0 hours 13.1 minutes. Best validation perplexity 161.68.
2017-08-03 05:10:29,562 _log_update: [35] (1.5 %) of epoch 13 -- lr = 2, duration = 32.0 ms
2017-08-03 05:11:33,557 _log_update: [235] (9.9 %) of epoch 13 -- lr = 2, duration = 32.0 ms
2017-08-03 05:12:37,535 _log_update: [435] (18.3 %) of epoch 13 -- lr = 2, duration = 31.8 ms
2017-08-03 05:13:41,539 _log_update: [635] (26.8 %) of epoch 13 -- lr = 2, duration = 31.8 ms
2017-08-03 05:14:45,529 _log_update: [835] (35.2 %) of epoch 13 -- lr = 2, duration = 31.8 ms
2017-08-03 05:15:49,498 _log_update: [1035] (43.7 %) of epoch 13 -- lr = 2, duration = 31.9 ms
2017-08-03 05:16:53,487 _log_update: [1235] (52.1 %) of epoch 13 -- lr = 2, duration = 32.0 ms
2017-08-03 05:17:57,455 _log_update: [1435] (60.5 %) of epoch 13 -- lr = 2, duration = 32.3 ms
2017-08-03 05:19:01,449 _log_update: [1635] (69.0 %) of epoch 13 -- lr = 2, duration = 31.9 ms
2017-08-03 05:20:05,443 _log_update: [1835] (77.4 %) of epoch 13 -- lr = 2, duration = 32.0 ms
2017-08-03 05:21:09,427 _log_update: [2035] (85.8 %) of epoch 13 -- lr = 2, duration = 31.9 ms
2017-08-03 05:22:13,449 _log_update: [2235] (94.3 %) of epoch 13 -- lr = 2, duration = 32.0 ms
2017-08-03 05:22:58,879 _validate: [2365] First validation sample, perplexity 162.90.
2017-08-03 05:23:11,357 _validate: [2368] Center of validation, perplexity 162.17.
2017-08-03 05:23:23,866 _validate: [2371] Last validation sample, perplexity 162.66.
2017-08-03 05:23:23,866 _log_validation: [2371] Validation set cost history: 355.2 260.2 238.5 210.7 194.7 175.4 166.7 166.1 163.8 162.9 162.2 [161.7] 162.2
2017-08-03 05:23:23,868 set_state: layers/projection_layer/W <- array(10001, 100)
2017-08-03 05:23:23,868 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-08-03 05:23:23,868 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-08-03 05:23:23,869 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-08-03 05:23:23,869 set_state: layers/output_layer/input/b <- array(10001,)
2017-08-03 05:23:23,872 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-08-03 05:23:23,874 _reset_state: [2368] (99.87 %) of epoch 12
2017-08-03 05:23:23,874 _log_validation: [2368] Validation set cost history: 355.2 260.2 238.5 210.7 194.7 175.4 166.7 166.1 163.8 162.9 162.2 [161.7]
2017-08-03 05:23:23,874 set_state: Restored iterator to line 42022 of 42068.
2017-08-03 05:23:23,875 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2017-08-03 05:23:23,875 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2017-08-03 05:23:23,876 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2017-08-03 05:23:23,883 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2017-08-03 05:23:23,885 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2017-08-03 05:23:23,885 set_state: layers/output_layer/input/b_gradient <- array(10001,)
Model performance stopped improving. Decreasing learning rate from 2.5 to 1.25 and resetting state to 100 % of epoch 12.
2017-08-03 05:23:23,886 _reset: Generating a random order of input lines.
Finished training epoch 12 in 0 hours 13.1 minutes. Best validation perplexity 161.68.
2017-08-03 05:23:44,343 _log_update: [64] (2.7 %) of epoch 13 -- lr = 1, duration = 31.9 ms
2017-08-03 05:24:48,330 _log_update: [264] (11.1 %) of epoch 13 -- lr = 1, duration = 32.0 ms
2017-08-03 05:25:52,295 _log_update: [464] (19.6 %) of epoch 13 -- lr = 1, duration = 31.9 ms
2017-08-03 05:26:56,279 _log_update: [664] (28.0 %) of epoch 13 -- lr = 1, duration = 32.1 ms
2017-08-03 05:28:00,254 _log_update: [864] (36.4 %) of epoch 13 -- lr = 1, duration = 32.6 ms
2017-08-03 05:29:04,266 _log_update: [1064] (44.9 %) of epoch 13 -- lr = 1, duration = 31.9 ms
2017-08-03 05:30:08,290 _log_update: [1264] (53.3 %) of epoch 13 -- lr = 1, duration = 32.1 ms
2017-08-03 05:31:12,277 _log_update: [1464] (61.7 %) of epoch 13 -- lr = 1, duration = 31.7 ms
2017-08-03 05:32:16,236 _log_update: [1664] (70.2 %) of epoch 13 -- lr = 1, duration = 31.8 ms
2017-08-03 05:33:20,200 _log_update: [1864] (78.6 %) of epoch 13 -- lr = 1, duration = 32.0 ms
2017-08-03 05:34:24,208 _log_update: [2064] (87.1 %) of epoch 13 -- lr = 1, duration = 31.8 ms
2017-08-03 05:35:28,190 _log_update: [2264] (95.5 %) of epoch 13 -- lr = 1, duration = 31.8 ms
2017-08-03 05:36:04,357 _validate: [2365] First validation sample, perplexity 161.01.
2017-08-03 05:36:16,836 _validate: [2368] Center of validation, perplexity 160.59.
2017-08-03 05:36:29,338 _validate: [2371] Last validation sample, perplexity 160.73.
2017-08-03 05:36:29,355 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-03 05:36:29,355 _log_validation: [2371] Validation set cost history: 355.2 260.2 238.5 210.7 194.7 175.4 166.7 166.1 163.8 162.9 162.2 161.7 [160.7]
2017-08-03 05:36:29,356 _reset: Generating a random order of input lines.
Finished training epoch 13 in 0 hours 13.1 minutes. Best validation perplexity 160.68.
2017-08-03 05:36:59,091 _log_update: [93] (3.9 %) of epoch 14 -- lr = 1, duration = 31.8 ms
2017-08-03 05:38:03,099 _log_update: [293] (12.4 %) of epoch 14 -- lr = 1, duration = 32.1 ms
2017-08-03 05:39:07,049 _log_update: [493] (20.8 %) of epoch 14 -- lr = 1, duration = 32.1 ms
2017-08-03 05:40:11,073 _log_update: [693] (29.2 %) of epoch 14 -- lr = 1, duration = 31.9 ms
2017-08-03 05:41:15,073 _log_update: [893] (37.7 %) of epoch 14 -- lr = 1, duration = 31.9 ms
2017-08-03 05:42:19,104 _log_update: [1093] (46.1 %) of epoch 14 -- lr = 1, duration = 32.1 ms
2017-08-03 05:43:23,072 _log_update: [1293] (54.5 %) of epoch 14 -- lr = 1, duration = 31.9 ms
2017-08-03 05:44:27,057 _log_update: [1493] (63.0 %) of epoch 14 -- lr = 1, duration = 31.8 ms
2017-08-03 05:45:31,041 _log_update: [1693] (71.4 %) of epoch 14 -- lr = 1, duration = 31.9 ms
2017-08-03 05:46:35,026 _log_update: [1893] (79.8 %) of epoch 14 -- lr = 1, duration = 31.9 ms
2017-08-03 05:47:39,032 _log_update: [2093] (88.3 %) of epoch 14 -- lr = 1, duration = 31.9 ms
2017-08-03 05:48:43,005 _log_update: [2293] (96.7 %) of epoch 14 -- lr = 1, duration = 31.9 ms
2017-08-03 05:49:09,907 _validate: [2365] First validation sample, perplexity 159.99.
2017-08-03 05:49:22,379 _validate: [2368] Center of validation, perplexity 160.11.
2017-08-03 05:49:34,874 _validate: [2371] Last validation sample, perplexity 160.14.
2017-08-03 05:49:34,891 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-03 05:49:34,891 _log_validation: [2371] Validation set cost history: 355.2 260.2 238.5 210.7 194.7 175.4 166.7 166.1 163.8 162.9 162.2 161.7 160.7 [160.1]
2017-08-03 05:49:34,892 _reset: Generating a random order of input lines.
Finished training epoch 14 in 0 hours 13.1 minutes. Best validation perplexity 160.11.
2017-08-03 05:50:13,904 _log_update: [122] (5.1 %) of epoch 15 -- lr = 1, duration = 32.0 ms
2017-08-03 05:51:17,863 _log_update: [322] (13.6 %) of epoch 15 -- lr = 1, duration = 31.7 ms
2017-08-03 05:52:21,842 _log_update: [522] (22.0 %) of epoch 15 -- lr = 1, duration = 31.9 ms
2017-08-03 05:53:25,804 _log_update: [722] (30.5 %) of epoch 15 -- lr = 1, duration = 31.9 ms
2017-08-03 05:54:29,799 _log_update: [922] (38.9 %) of epoch 15 -- lr = 1, duration = 32.0 ms
2017-08-03 05:55:33,761 _log_update: [1122] (47.3 %) of epoch 15 -- lr = 1, duration = 31.9 ms
2017-08-03 05:56:37,730 _log_update: [1322] (55.8 %) of epoch 15 -- lr = 1, duration = 31.6 ms
2017-08-03 05:57:41,756 _log_update: [1522] (64.2 %) of epoch 15 -- lr = 1, duration = 31.9 ms
2017-08-03 05:58:45,746 _log_update: [1722] (72.6 %) of epoch 15 -- lr = 1, duration = 32.0 ms
2017-08-03 05:59:49,738 _log_update: [1922] (81.1 %) of epoch 15 -- lr = 1, duration = 31.9 ms
2017-08-03 06:00:53,752 _log_update: [2122] (89.5 %) of epoch 15 -- lr = 1, duration = 31.8 ms
2017-08-03 06:01:57,752 _log_update: [2322] (97.9 %) of epoch 15 -- lr = 1, duration = 32.0 ms
2017-08-03 06:02:15,388 _validate: [2365] First validation sample, perplexity 160.91.
2017-08-03 06:02:27,878 _validate: [2368] Center of validation, perplexity 160.97.
2017-08-03 06:02:40,363 _validate: [2371] Last validation sample, perplexity 161.23.
2017-08-03 06:02:40,363 _log_validation: [2371] Validation set cost history: 355.2 260.2 238.5 210.7 194.7 175.4 166.7 166.1 163.8 162.9 162.2 161.7 160.7 [160.1] 161.2
2017-08-03 06:02:40,364 set_state: layers/projection_layer/W <- array(10001, 100)
2017-08-03 06:02:40,365 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-08-03 06:02:40,365 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-08-03 06:02:40,366 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-08-03 06:02:40,366 set_state: layers/output_layer/input/b <- array(10001,)
2017-08-03 06:02:40,369 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-08-03 06:02:40,370 _reset_state: [2368] (99.87 %) of epoch 14
2017-08-03 06:02:40,370 _log_validation: [2368] Validation set cost history: 355.2 260.2 238.5 210.7 194.7 175.4 166.7 166.1 163.8 162.9 162.2 161.7 160.7 [160.1]
2017-08-03 06:02:40,371 set_state: Restored iterator to line 42022 of 42068.
2017-08-03 06:02:40,371 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2017-08-03 06:02:40,372 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2017-08-03 06:02:40,372 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2017-08-03 06:02:40,380 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2017-08-03 06:02:40,381 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2017-08-03 06:02:40,381 set_state: layers/output_layer/input/b_gradient <- array(10001,)
Model performance stopped improving. Decreasing learning rate from 1.25 to 0.625 and resetting state to 100 % of epoch 14.
2017-08-03 06:02:40,382 _reset: Generating a random order of input lines.
Finished training epoch 14 in 0 hours 13.1 minutes. Best validation perplexity 160.11.
2017-08-03 06:03:28,828 _log_update: [151] (6.4 %) of epoch 15 -- lr = 0.6, duration = 32.0 ms
2017-08-03 06:04:33,074 _log_update: [351] (14.8 %) of epoch 15 -- lr = 0.6, duration = 32.3 ms
2017-08-03 06:05:37,300 _log_update: [551] (23.2 %) of epoch 15 -- lr = 0.6, duration = 32.0 ms
2017-08-03 06:06:41,564 _log_update: [751] (31.7 %) of epoch 15 -- lr = 0.6, duration = 32.2 ms
2017-08-03 06:07:45,756 _log_update: [951] (40.1 %) of epoch 15 -- lr = 0.6, duration = 32.0 ms
2017-08-03 06:08:49,952 _log_update: [1151] (48.5 %) of epoch 15 -- lr = 0.6, duration = 31.9 ms
2017-08-03 06:09:54,140 _log_update: [1351] (57.0 %) of epoch 15 -- lr = 0.6, duration = 32.1 ms
2017-08-03 06:10:58,357 _log_update: [1551] (65.4 %) of epoch 15 -- lr = 0.6, duration = 32.2 ms
2017-08-03 06:12:02,550 _log_update: [1751] (73.9 %) of epoch 15 -- lr = 0.6, duration = 31.9 ms
2017-08-03 06:13:06,782 _log_update: [1951] (82.3 %) of epoch 15 -- lr = 0.6, duration = 32.1 ms
2017-08-03 06:14:10,990 _log_update: [2151] (90.7 %) of epoch 15 -- lr = 0.6, duration = 32.0 ms
2017-08-03 06:15:15,191 _log_update: [2351] (99.2 %) of epoch 15 -- lr = 0.6, duration = 31.9 ms
2017-08-03 06:15:23,534 _validate: [2365] First validation sample, perplexity 161.16.
2017-08-03 06:15:36,002 _validate: [2368] Center of validation, perplexity 160.91.
2017-08-03 06:15:48,476 _validate: [2371] Last validation sample, perplexity 160.66.
2017-08-03 06:15:48,476 _log_validation: [2371] Validation set cost history: 355.2 260.2 238.5 210.7 194.7 175.4 166.7 166.1 163.8 162.9 162.2 161.7 160.7 [160.1] 160.9
2017-08-03 06:15:48,478 set_state: layers/projection_layer/W <- array(10001, 100)
2017-08-03 06:15:48,478 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-08-03 06:15:48,479 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-08-03 06:15:48,479 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-08-03 06:15:48,479 set_state: layers/output_layer/input/b <- array(10001,)
2017-08-03 06:15:48,482 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-08-03 06:15:48,484 _reset_state: [2368] (99.87 %) of epoch 14
2017-08-03 06:15:48,484 _log_validation: [2368] Validation set cost history: 355.2 260.2 238.5 210.7 194.7 175.4 166.7 166.1 163.8 162.9 162.2 161.7 160.7 [160.1]
2017-08-03 06:15:48,484 set_state: Restored iterator to line 42022 of 42068.
2017-08-03 06:15:48,485 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2017-08-03 06:15:48,485 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2017-08-03 06:15:48,486 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2017-08-03 06:15:48,494 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2017-08-03 06:15:48,495 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2017-08-03 06:15:48,496 set_state: layers/output_layer/input/b_gradient <- array(10001,)
Model performance stopped improving. Decreasing learning rate from 0.625 to 0.3125 and resetting state to 100 % of epoch 14.
Finished training epoch 14 in 0 hours 13.1 minutes. Best validation perplexity 160.11.
Training finished in 4 hours 22.0 minutes.
2017-08-03 06:15:48,498 set_state: layers/projection_layer/W <- array(10001, 100)
2017-08-03 06:15:48,499 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-08-03 06:15:48,499 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-08-03 06:15:48,500 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-08-03 06:15:48,500 set_state: layers/output_layer/input/b <- array(10001,)
2017-08-03 06:15:48,504 set_state: layers/output_layer/input/W <- array(256, 10001)
Best validation set perplexity: 160.113446741
train finished.
Computing evaluation set perplexity.
Reading vocabulary from network state.
Number of words in vocabulary: 10001
Number of words in shortlist: 10001
Number of word classes: 10001
Building neural network.
Restoring neural network state.
Building text scorer.
Number of sentences: 3761
Number of words: 86191
Number of tokens: 86191
Number of predicted probabilities: 82430
Number of excluded (OOV) words: 0
Number of zero probabilities: 0
Cross entropy (base e): 4.888861120701164
Perplexity: 132.80224216882067
