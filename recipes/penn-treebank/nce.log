/l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab
THEANO_FLAGS=floatX=float32,device=cuda0
Reading vocabulary from /l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab.
Computing unigram probabilities for out-of-shortlist words.
Number of words in vocabulary: 10001
Number of words in shortlist: 10001
Number of word classes: 10001
2017-08-01 11:54:46,967 train: TRAINING OPTIONS
2017-08-01 11:54:46,967 train: max_epochs: 15
2017-08-01 11:54:46,967 train: sequence_length: 25
2017-08-01 11:54:46,967 train: batch_size: 24
2017-08-01 11:54:46,967 train: min_epochs: 1
2017-08-01 11:54:46,967 train: stopping_criterion: no-improvement
2017-08-01 11:54:46,967 train: max_annealing_count: 0
2017-08-01 11:54:46,967 train: patience: 0
2017-08-01 11:54:46,967 train: validation_frequency: 1
2017-08-01 11:54:46,967 train: OPTIMIZATION OPTIONS
2017-08-01 11:54:46,967 train: gradient_decay_rate: 0.9
2017-08-01 11:54:46,967 train: epsilon: 1e-06
2017-08-01 11:54:46,967 train: max_gradient_norm: 5.0
2017-08-01 11:54:46,967 train: exclude_unk: False
2017-08-01 11:54:46,967 train: noise_sharing: None
2017-08-01 11:54:46,967 train: method: sgd
2017-08-01 11:54:46,968 train: num_noise_samples: 25
2017-08-01 11:54:46,968 train: momentum: 0.9
2017-08-01 11:54:46,968 train: cost_function: nce
2017-08-01 11:54:46,968 train: sqr_gradient_decay_rate: 0.999
2017-08-01 11:54:46,968 train: learning_rate: 20.0
2017-08-01 11:54:46,968 train: weights: [ 1.]
Creating trainer.
Computing the number of mini-batches in training data.
2017-08-01 11:54:48,288 __init__: One epoch of training data contains 2371 mini-batch updates.
2017-08-01 11:54:48,289 __init__: Class unigram log probabilities are in the range [-13.786758, -2.951697].
2017-08-01 11:54:48,289 __init__: Finding sentence start positions in /teamwork/t40511_asr/c/penn-treebank-project/ptb.train.txt.
2017-08-01 11:54:48,309 _reset: Generating a random order of input lines.
Building neural network.
2017-08-01 11:54:48,316 __init__: Creating layers.
2017-08-01 11:54:48,316 __init__: - NetworkInput name=word_input inputs=[] size=10001 depth=1 devices=[]
2017-08-01 11:54:48,316 __init__: - ProjectionLayer name=projection_layer inputs=[word_input] size=100 depth=1 devices=[None]
2017-08-01 11:54:48,395 add:      * layers/projection_layer/W size=1000100 type=float32 device=None
2017-08-01 11:54:48,395 __init__: - LSTMLayer name=hidden_layer inputs=[projection_layer] size=256 depth=1 devices=[None]
2017-08-01 11:54:48,403 add:      * layers/hidden_layer/layer_input/W size=102400 type=float32 device=None
2017-08-01 11:54:48,686 add:      * layers/hidden_layer/step_input/W size=262144 type=float32 device=None
2017-08-01 11:54:48,686 add:      * layers/hidden_layer/layer_input/b size=1024 type=float32 device=None
2017-08-01 11:54:48,686 __init__: - SoftmaxLayer name=output_layer inputs=[hidden_layer] size=10001 depth=1 devices=[None]
2017-08-01 11:54:48,905 add:      * layers/output_layer/input/W size=2560256 type=float32 device=None
2017-08-01 11:54:48,905 add:      * layers/output_layer/input/b size=10001 type=float32 device=None
2017-08-01 11:54:48,906 __init__: Total number of parameters: 3935925
Compiling optimization function.
2017-08-01 11:54:50,956 add:      * layers/hidden_layer/layer_input/b_gradient size=1024 type=float32 device=None
2017-08-01 11:54:50,956 add:      * layers/hidden_layer/step_input/W_gradient size=262144 type=float32 device=None
2017-08-01 11:54:50,958 add:      * layers/projection_layer/W_gradient size=1000100 type=float32 device=None
2017-08-01 11:54:50,959 add:      * layers/hidden_layer/layer_input/W_gradient size=102400 type=float32 device=None
2017-08-01 11:54:50,963 add:      * layers/output_layer/input/W_gradient size=2560256 type=float32 device=None
2017-08-01 11:54:50,964 add:      * layers/output_layer/input/b_gradient size=10001 type=float32 device=None
Building text scorer for cross-validation.
Validation text: /teamwork/t40511_asr/c/penn-treebank-project/ptb.valid.txt
Training neural network.
2017-08-01 11:57:03,769 _log_update: [200] (8.4 %) of epoch 1 -- lr = 2e+01, duration = 31.9 ms
2017-08-01 11:58:07,646 _log_update: [400] (16.9 %) of epoch 1 -- lr = 2e+01, duration = 31.8 ms
2017-08-01 11:59:11,577 _log_update: [600] (25.3 %) of epoch 1 -- lr = 2e+01, duration = 32.1 ms
2017-08-01 12:00:15,451 _log_update: [800] (33.7 %) of epoch 1 -- lr = 2e+01, duration = 31.7 ms
2017-08-01 12:01:19,338 _log_update: [1000] (42.2 %) of epoch 1 -- lr = 2e+01, duration = 31.7 ms
2017-08-01 12:02:23,273 _log_update: [1200] (50.6 %) of epoch 1 -- lr = 2e+01, duration = 32.0 ms
2017-08-01 12:03:27,204 _log_update: [1400] (59.0 %) of epoch 1 -- lr = 2e+01, duration = 31.8 ms
2017-08-01 12:04:31,182 _log_update: [1600] (67.5 %) of epoch 1 -- lr = 2e+01, duration = 31.8 ms
2017-08-01 12:05:35,120 _log_update: [1800] (75.9 %) of epoch 1 -- lr = 2e+01, duration = 32.0 ms
2017-08-01 12:06:39,057 _log_update: [2000] (84.4 %) of epoch 1 -- lr = 2e+01, duration = 31.8 ms
2017-08-01 12:07:44,232 _log_update: [2200] (92.8 %) of epoch 1 -- lr = 2e+01, duration = 31.9 ms
2017-08-01 12:08:40,920 _validate: [2365] First validation sample, perplexity 325.41.
2017-08-01 12:08:53,414 _validate: [2368] Center of validation, perplexity 332.70.
2017-08-01 12:09:05,914 _validate: [2371] Last validation sample, perplexity 343.60.
2017-08-01 12:09:05,932 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-01 12:09:05,932 _log_validation: [2371] Validation set cost history: [338.1]
2017-08-01 12:09:05,933 _reset: Generating a random order of input lines.
Finished training epoch 1 in 0 hours 13.1 minutes. Best validation perplexity 338.06.
2017-08-01 12:09:15,196 _log_update: [29] (1.2 %) of epoch 2 -- lr = 2e+01, duration = 31.8 ms
2017-08-01 12:10:19,145 _log_update: [229] (9.7 %) of epoch 2 -- lr = 2e+01, duration = 31.8 ms
2017-08-01 12:11:23,065 _log_update: [429] (18.1 %) of epoch 2 -- lr = 2e+01, duration = 32.0 ms
2017-08-01 12:12:27,029 _log_update: [629] (26.5 %) of epoch 2 -- lr = 2e+01, duration = 32.1 ms
2017-08-01 12:13:30,994 _log_update: [829] (35.0 %) of epoch 2 -- lr = 2e+01, duration = 31.9 ms
2017-08-01 12:14:34,946 _log_update: [1029] (43.4 %) of epoch 2 -- lr = 2e+01, duration = 31.8 ms
2017-08-01 12:15:38,940 _log_update: [1229] (51.8 %) of epoch 2 -- lr = 2e+01, duration = 32.2 ms
2017-08-01 12:16:42,829 _log_update: [1429] (60.3 %) of epoch 2 -- lr = 2e+01, duration = 32.0 ms
2017-08-01 12:17:46,757 _log_update: [1629] (68.7 %) of epoch 2 -- lr = 2e+01, duration = 31.9 ms
2017-08-01 12:18:50,711 _log_update: [1829] (77.1 %) of epoch 2 -- lr = 2e+01, duration = 32.3 ms
2017-08-01 12:19:54,623 _log_update: [2029] (85.6 %) of epoch 2 -- lr = 2e+01, duration = 32.3 ms
2017-08-01 12:20:58,582 _log_update: [2229] (94.0 %) of epoch 2 -- lr = 2e+01, duration = 32.1 ms
2017-08-01 12:21:45,937 _validate: [2365] First validation sample, perplexity 258.08.
2017-08-01 12:21:58,404 _validate: [2368] Center of validation, perplexity 263.80.
2017-08-01 12:22:10,913 _validate: [2371] Last validation sample, perplexity 291.96.
2017-08-01 12:22:10,929 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-01 12:22:10,929 _log_validation: [2371] Validation set cost history: 338.1 [263.8]
2017-08-01 12:22:10,930 _reset: Generating a random order of input lines.
Finished training epoch 2 in 0 hours 13.1 minutes. Best validation perplexity 263.76.
2017-08-01 12:22:29,461 _log_update: [58] (2.4 %) of epoch 3 -- lr = 2e+01, duration = 31.9 ms
2017-08-01 12:23:33,388 _log_update: [258] (10.9 %) of epoch 3 -- lr = 2e+01, duration = 32.0 ms
2017-08-01 12:24:37,325 _log_update: [458] (19.3 %) of epoch 3 -- lr = 2e+01, duration = 31.8 ms
2017-08-01 12:25:41,251 _log_update: [658] (27.8 %) of epoch 3 -- lr = 2e+01, duration = 32.1 ms
2017-08-01 12:26:45,190 _log_update: [858] (36.2 %) of epoch 3 -- lr = 2e+01, duration = 31.8 ms
2017-08-01 12:27:49,130 _log_update: [1058] (44.6 %) of epoch 3 -- lr = 2e+01, duration = 31.7 ms
2017-08-01 12:28:53,053 _log_update: [1258] (53.1 %) of epoch 3 -- lr = 2e+01, duration = 31.7 ms
2017-08-01 12:29:56,975 _log_update: [1458] (61.5 %) of epoch 3 -- lr = 2e+01, duration = 32.0 ms
2017-08-01 12:31:00,875 _log_update: [1658] (69.9 %) of epoch 3 -- lr = 2e+01, duration = 32.2 ms
2017-08-01 12:32:04,785 _log_update: [1858] (78.4 %) of epoch 3 -- lr = 2e+01, duration = 31.7 ms
2017-08-01 12:33:08,689 _log_update: [2058] (86.8 %) of epoch 3 -- lr = 2e+01, duration = 31.8 ms
2017-08-01 12:34:12,610 _log_update: [2258] (95.2 %) of epoch 3 -- lr = 2e+01, duration = 32.0 ms
2017-08-01 12:34:50,663 _validate: [2365] First validation sample, perplexity 246.52.
2017-08-01 12:35:03,129 _validate: [2368] Center of validation, perplexity 233.46.
2017-08-01 12:35:15,609 _validate: [2371] Last validation sample, perplexity 266.39.
2017-08-01 12:35:15,624 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-01 12:35:15,624 _log_validation: [2371] Validation set cost history: 338.1 263.8 [240.3]
2017-08-01 12:35:15,625 _reset: Generating a random order of input lines.
Finished training epoch 3 in 0 hours 13.1 minutes. Best validation perplexity 240.27.
2017-08-01 12:35:43,409 _log_update: [87] (3.7 %) of epoch 4 -- lr = 2e+01, duration = 31.9 ms
2017-08-01 12:36:47,342 _log_update: [287] (12.1 %) of epoch 4 -- lr = 2e+01, duration = 31.8 ms
2017-08-01 12:37:51,286 _log_update: [487] (20.5 %) of epoch 4 -- lr = 2e+01, duration = 31.9 ms
2017-08-01 12:38:55,201 _log_update: [687] (29.0 %) of epoch 4 -- lr = 2e+01, duration = 31.9 ms
2017-08-01 12:39:59,158 _log_update: [887] (37.4 %) of epoch 4 -- lr = 2e+01, duration = 31.9 ms
2017-08-01 12:41:03,128 _log_update: [1087] (45.8 %) of epoch 4 -- lr = 2e+01, duration = 31.7 ms
2017-08-01 12:42:07,029 _log_update: [1287] (54.3 %) of epoch 4 -- lr = 2e+01, duration = 31.6 ms
2017-08-01 12:43:10,932 _log_update: [1487] (62.7 %) of epoch 4 -- lr = 2e+01, duration = 31.8 ms
2017-08-01 12:44:14,834 _log_update: [1687] (71.2 %) of epoch 4 -- lr = 2e+01, duration = 31.8 ms
2017-08-01 12:45:18,770 _log_update: [1887] (79.6 %) of epoch 4 -- lr = 2e+01, duration = 31.8 ms
2017-08-01 12:46:22,708 _log_update: [2087] (88.0 %) of epoch 4 -- lr = 2e+01, duration = 32.0 ms
2017-08-01 12:47:26,662 _log_update: [2287] (96.5 %) of epoch 4 -- lr = 2e+01, duration = 31.9 ms
2017-08-01 12:47:55,457 _validate: [2365] First validation sample, perplexity 278.93.
2017-08-01 12:48:07,933 _validate: [2368] Center of validation, perplexity 212.36.
2017-08-01 12:48:20,426 _validate: [2371] Last validation sample, perplexity 246.35.
2017-08-01 12:48:20,441 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-01 12:48:20,442 _log_validation: [2371] Validation set cost history: 338.1 263.8 240.3 [216.1]
2017-08-01 12:48:20,443 _reset: Generating a random order of input lines.
Finished training epoch 4 in 0 hours 13.1 minutes. Best validation perplexity 216.06.
2017-08-01 12:48:57,478 _log_update: [116] (4.9 %) of epoch 5 -- lr = 2e+01, duration = 31.9 ms
2017-08-01 12:50:01,362 _log_update: [316] (13.3 %) of epoch 5 -- lr = 2e+01, duration = 31.9 ms
2017-08-01 12:51:05,257 _log_update: [516] (21.8 %) of epoch 5 -- lr = 2e+01, duration = 31.8 ms
2017-08-01 12:52:09,161 _log_update: [716] (30.2 %) of epoch 5 -- lr = 2e+01, duration = 31.7 ms
2017-08-01 12:53:13,026 _log_update: [916] (38.6 %) of epoch 5 -- lr = 2e+01, duration = 32.1 ms
2017-08-01 12:54:16,936 _log_update: [1116] (47.1 %) of epoch 5 -- lr = 2e+01, duration = 31.6 ms
2017-08-01 12:55:20,825 _log_update: [1316] (55.5 %) of epoch 5 -- lr = 2e+01, duration = 32.0 ms
2017-08-01 12:56:24,755 _log_update: [1516] (63.9 %) of epoch 5 -- lr = 2e+01, duration = 32.0 ms
2017-08-01 12:57:28,638 _log_update: [1716] (72.4 %) of epoch 5 -- lr = 2e+01, duration = 31.9 ms
2017-08-01 12:58:32,532 _log_update: [1916] (80.8 %) of epoch 5 -- lr = 2e+01, duration = 32.1 ms
2017-08-01 12:59:36,409 _log_update: [2116] (89.2 %) of epoch 5 -- lr = 2e+01, duration = 32.1 ms
2017-08-01 13:00:40,310 _log_update: [2316] (97.7 %) of epoch 5 -- lr = 2e+01, duration = 31.7 ms
2017-08-01 13:00:59,808 _validate: [2365] First validation sample, perplexity 196.26.
2017-08-01 13:01:12,266 _validate: [2368] Center of validation, perplexity 196.65.
2017-08-01 13:01:24,739 _validate: [2371] Last validation sample, perplexity 253.79.
2017-08-01 13:01:24,755 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-01 13:01:24,755 _log_validation: [2371] Validation set cost history: 338.1 263.8 240.3 216.1 [200.4]
2017-08-01 13:01:24,756 _reset: Generating a random order of input lines.
Finished training epoch 5 in 0 hours 13.1 minutes. Best validation perplexity 200.37.
2017-08-01 13:02:11,130 _log_update: [145] (6.1 %) of epoch 6 -- lr = 2e+01, duration = 32.0 ms
2017-08-01 13:03:15,074 _log_update: [345] (14.6 %) of epoch 6 -- lr = 2e+01, duration = 32.0 ms
2017-08-01 13:04:19,002 _log_update: [545] (23.0 %) of epoch 6 -- lr = 2e+01, duration = 31.9 ms
2017-08-01 13:05:22,921 _log_update: [745] (31.4 %) of epoch 6 -- lr = 2e+01, duration = 31.8 ms
2017-08-01 13:06:26,868 _log_update: [945] (39.9 %) of epoch 6 -- lr = 2e+01, duration = 31.9 ms
2017-08-01 13:07:30,804 _log_update: [1145] (48.3 %) of epoch 6 -- lr = 2e+01, duration = 32.2 ms
2017-08-01 13:08:34,760 _log_update: [1345] (56.7 %) of epoch 6 -- lr = 2e+01, duration = 31.7 ms
2017-08-01 13:09:38,713 _log_update: [1545] (65.2 %) of epoch 6 -- lr = 2e+01, duration = 31.8 ms
2017-08-01 13:10:42,652 _log_update: [1745] (73.6 %) of epoch 6 -- lr = 2e+01, duration = 31.8 ms
2017-08-01 13:11:46,599 _log_update: [1945] (82.0 %) of epoch 6 -- lr = 2e+01, duration = 31.8 ms
2017-08-01 13:12:50,536 _log_update: [2145] (90.5 %) of epoch 6 -- lr = 2e+01, duration = 31.8 ms
2017-08-01 13:13:54,437 _log_update: [2345] (98.9 %) of epoch 6 -- lr = 2e+01, duration = 31.8 ms
2017-08-01 13:14:04,692 _validate: [2365] First validation sample, perplexity 194.57.
2017-08-01 13:14:17,150 _validate: [2368] Center of validation, perplexity 219.12.
2017-08-01 13:14:29,619 _validate: [2371] Last validation sample, perplexity 229.28.
2017-08-01 13:14:29,619 _log_validation: [2371] Validation set cost history: 338.1 263.8 240.3 216.1 [200.4] 212.1
2017-08-01 13:14:29,621 set_state: layers/projection_layer/W <- array(10001, 100)
2017-08-01 13:14:29,621 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-08-01 13:14:29,622 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-08-01 13:14:29,622 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-08-01 13:14:29,625 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-08-01 13:14:29,626 set_state: layers/output_layer/input/b <- array(10001,)
2017-08-01 13:14:29,627 _reset_state: [2368] (99.87 %) of epoch 5
2017-08-01 13:14:29,627 _log_validation: [2368] Validation set cost history: 338.1 263.8 240.3 216.1 [200.4]
2017-08-01 13:14:29,628 set_state: Restored iterator to line 42026 of 42068.
2017-08-01 13:14:29,628 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2017-08-01 13:14:29,628 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2017-08-01 13:14:29,630 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2017-08-01 13:14:29,630 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2017-08-01 13:14:29,638 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2017-08-01 13:14:29,638 set_state: layers/output_layer/input/b_gradient <- array(10001,)
Model performance stopped improving. Decreasing learning rate from 20.0 to 10.0 and resetting state to 100 % of epoch 5.
2017-08-01 13:14:29,639 _reset: Generating a random order of input lines.
Finished training epoch 5 in 0 hours 13.1 minutes. Best validation perplexity 200.37.
2017-08-01 13:15:25,212 _log_update: [174] (7.3 %) of epoch 6 -- lr = 1e+01, duration = 31.8 ms
2017-08-01 13:16:29,120 _log_update: [374] (15.8 %) of epoch 6 -- lr = 1e+01, duration = 31.8 ms
2017-08-01 13:17:32,994 _log_update: [574] (24.2 %) of epoch 6 -- lr = 1e+01, duration = 31.8 ms
2017-08-01 13:18:36,892 _log_update: [774] (32.6 %) of epoch 6 -- lr = 1e+01, duration = 31.9 ms
2017-08-01 13:19:40,834 _log_update: [974] (41.1 %) of epoch 6 -- lr = 1e+01, duration = 31.7 ms
2017-08-01 13:20:45,698 _log_update: [1174] (49.5 %) of epoch 6 -- lr = 1e+01, duration = 31.9 ms
2017-08-01 13:21:49,614 _log_update: [1374] (58.0 %) of epoch 6 -- lr = 1e+01, duration = 31.8 ms
2017-08-01 13:22:53,509 _log_update: [1574] (66.4 %) of epoch 6 -- lr = 1e+01, duration = 31.6 ms
2017-08-01 13:23:57,424 _log_update: [1774] (74.8 %) of epoch 6 -- lr = 1e+01, duration = 31.8 ms
2017-08-01 13:25:01,347 _log_update: [1974] (83.3 %) of epoch 6 -- lr = 1e+01, duration = 32.0 ms
2017-08-01 13:26:05,252 _log_update: [2174] (91.7 %) of epoch 6 -- lr = 1e+01, duration = 31.9 ms
2017-08-01 13:27:10,126 _validate: [2365] First validation sample, perplexity 182.60.
2017-08-01 13:27:22,585 _validate: [2368] Center of validation, perplexity 178.05.
2017-08-01 13:27:35,055 _validate: [2371] Last validation sample, perplexity 182.06.
2017-08-01 13:27:35,070 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-01 13:27:35,071 _log_validation: [2371] Validation set cost history: 338.1 263.8 240.3 216.1 200.4 [181.0]
2017-08-01 13:27:35,072 _reset: Generating a random order of input lines.
Finished training epoch 6 in 0 hours 13.1 minutes. Best validation perplexity 181.04.
2017-08-01 13:27:36,014 _log_update: [3] (0.1 %) of epoch 7 -- lr = 1e+01, duration = 31.7 ms
2017-08-01 13:28:39,958 _log_update: [203] (8.6 %) of epoch 7 -- lr = 1e+01, duration = 32.0 ms
2017-08-01 13:29:43,815 _log_update: [403] (17.0 %) of epoch 7 -- lr = 1e+01, duration = 32.4 ms
2017-08-01 13:30:47,783 _log_update: [603] (25.4 %) of epoch 7 -- lr = 1e+01, duration = 31.9 ms
2017-08-01 13:31:51,727 _log_update: [803] (33.9 %) of epoch 7 -- lr = 1e+01, duration = 31.9 ms
2017-08-01 13:32:55,617 _log_update: [1003] (42.3 %) of epoch 7 -- lr = 1e+01, duration = 31.8 ms
2017-08-01 13:33:59,522 _log_update: [1203] (50.7 %) of epoch 7 -- lr = 1e+01, duration = 31.8 ms
2017-08-01 13:35:03,449 _log_update: [1403] (59.2 %) of epoch 7 -- lr = 1e+01, duration = 31.9 ms
2017-08-01 13:36:07,382 _log_update: [1603] (67.6 %) of epoch 7 -- lr = 1e+01, duration = 31.9 ms
2017-08-01 13:37:11,343 _log_update: [1803] (76.0 %) of epoch 7 -- lr = 1e+01, duration = 32.0 ms
2017-08-01 13:38:15,255 _log_update: [2003] (84.5 %) of epoch 7 -- lr = 1e+01, duration = 32.1 ms
2017-08-01 13:39:19,157 _log_update: [2203] (92.9 %) of epoch 7 -- lr = 1e+01, duration = 31.9 ms
2017-08-01 13:40:14,797 _validate: [2365] First validation sample, perplexity 181.38.
2017-08-01 13:40:27,259 _validate: [2368] Center of validation, perplexity 179.93.
2017-08-01 13:40:39,732 _validate: [2371] Last validation sample, perplexity 182.89.
2017-08-01 13:40:39,733 _log_validation: [2371] Validation set cost history: 338.1 263.8 240.3 216.1 200.4 [181.0] 181.4
2017-08-01 13:40:39,734 set_state: layers/projection_layer/W <- array(10001, 100)
2017-08-01 13:40:39,735 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-08-01 13:40:39,735 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-08-01 13:40:39,736 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-08-01 13:40:39,739 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-08-01 13:40:39,739 set_state: layers/output_layer/input/b <- array(10001,)
2017-08-01 13:40:39,740 _reset_state: [2368] (99.87 %) of epoch 6
2017-08-01 13:40:39,741 _log_validation: [2368] Validation set cost history: 338.1 263.8 240.3 216.1 200.4 [181.0]
2017-08-01 13:40:39,741 set_state: Restored iterator to line 42028 of 42068.
2017-08-01 13:40:39,742 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2017-08-01 13:40:39,742 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2017-08-01 13:40:39,743 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2017-08-01 13:40:39,744 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2017-08-01 13:40:39,751 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2017-08-01 13:40:39,752 set_state: layers/output_layer/input/b_gradient <- array(10001,)
Model performance stopped improving. Decreasing learning rate from 10.0 to 5.0 and resetting state to 100 % of epoch 6.
2017-08-01 13:40:39,753 _reset: Generating a random order of input lines.
Finished training epoch 6 in 0 hours 13.1 minutes. Best validation perplexity 181.04.
2017-08-01 13:40:49,965 _log_update: [32] (1.3 %) of epoch 7 -- lr = 5, duration = 31.9 ms
2017-08-01 13:41:55,137 _log_update: [232] (9.8 %) of epoch 7 -- lr = 5, duration = 31.9 ms
2017-08-01 13:42:59,111 _log_update: [432] (18.2 %) of epoch 7 -- lr = 5, duration = 31.9 ms
2017-08-01 13:44:03,039 _log_update: [632] (26.7 %) of epoch 7 -- lr = 5, duration = 31.9 ms
2017-08-01 13:45:06,952 _log_update: [832] (35.1 %) of epoch 7 -- lr = 5, duration = 31.8 ms
2017-08-01 13:46:10,898 _log_update: [1032] (43.5 %) of epoch 7 -- lr = 5, duration = 32.2 ms
2017-08-01 13:47:14,818 _log_update: [1232] (52.0 %) of epoch 7 -- lr = 5, duration = 31.7 ms
2017-08-01 13:48:18,706 _log_update: [1432] (60.4 %) of epoch 7 -- lr = 5, duration = 31.8 ms
2017-08-01 13:49:22,636 _log_update: [1632] (68.8 %) of epoch 7 -- lr = 5, duration = 32.0 ms
2017-08-01 13:50:26,538 _log_update: [1832] (77.3 %) of epoch 7 -- lr = 5, duration = 31.7 ms
2017-08-01 13:51:30,446 _log_update: [2032] (85.7 %) of epoch 7 -- lr = 5, duration = 31.7 ms
2017-08-01 13:52:34,367 _log_update: [2232] (94.1 %) of epoch 7 -- lr = 5, duration = 32.1 ms
2017-08-01 13:53:20,708 _validate: [2365] First validation sample, perplexity 171.77.
2017-08-01 13:53:33,165 _validate: [2368] Center of validation, perplexity 173.38.
2017-08-01 13:53:45,658 _validate: [2371] Last validation sample, perplexity 177.38.
2017-08-01 13:53:45,674 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-01 13:53:45,674 _log_validation: [2371] Validation set cost history: 338.1 263.8 240.3 216.1 200.4 181.0 [173.2]
2017-08-01 13:53:45,675 _reset: Generating a random order of input lines.
Finished training epoch 7 in 0 hours 13.1 minutes. Best validation perplexity 173.22.
2017-08-01 13:54:05,165 _log_update: [61] (2.6 %) of epoch 8 -- lr = 5, duration = 31.9 ms
2017-08-01 13:55:09,096 _log_update: [261] (11.0 %) of epoch 8 -- lr = 5, duration = 32.3 ms
2017-08-01 13:56:13,072 _log_update: [461] (19.4 %) of epoch 8 -- lr = 5, duration = 32.0 ms
2017-08-01 13:57:17,020 _log_update: [661] (27.9 %) of epoch 8 -- lr = 5, duration = 31.8 ms
2017-08-01 13:58:20,973 _log_update: [861] (36.3 %) of epoch 8 -- lr = 5, duration = 31.5 ms
2017-08-01 13:59:25,517 _log_update: [1061] (44.7 %) of epoch 8 -- lr = 5, duration = 32.7 ms
2017-08-01 14:00:30,790 _log_update: [1261] (53.2 %) of epoch 8 -- lr = 5, duration = 32.0 ms
2017-08-01 14:01:35,506 _log_update: [1461] (61.6 %) of epoch 8 -- lr = 5, duration = 32.0 ms
2017-08-01 14:02:39,893 _log_update: [1661] (70.1 %) of epoch 8 -- lr = 5, duration = 31.8 ms
2017-08-01 14:03:44,347 _log_update: [1861] (78.5 %) of epoch 8 -- lr = 5, duration = 32.0 ms
2017-08-01 14:04:48,860 _log_update: [2061] (86.9 %) of epoch 8 -- lr = 5, duration = 32.1 ms
2017-08-01 14:05:53,465 _log_update: [2261] (95.4 %) of epoch 8 -- lr = 5, duration = 32.7 ms
2017-08-01 14:06:31,143 _validate: [2365] First validation sample, perplexity 169.74.
2017-08-01 14:06:43,761 _validate: [2368] Center of validation, perplexity 170.34.
2017-08-01 14:06:56,655 _validate: [2371] Last validation sample, perplexity 171.98.
2017-08-01 14:06:56,671 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-01 14:06:56,671 _log_validation: [2371] Validation set cost history: 338.1 263.8 240.3 216.1 200.4 181.0 173.2 [171.8]
2017-08-01 14:06:56,672 _reset: Generating a random order of input lines.
Finished training epoch 8 in 0 hours 13.2 minutes. Best validation perplexity 171.81.
2017-08-01 14:07:25,645 _log_update: [90] (3.8 %) of epoch 9 -- lr = 5, duration = 32.0 ms
2017-08-01 14:08:30,630 _log_update: [290] (12.2 %) of epoch 9 -- lr = 5, duration = 31.7 ms
2017-08-01 14:09:35,383 _log_update: [490] (20.7 %) of epoch 9 -- lr = 5, duration = 32.0 ms
2017-08-01 14:10:39,586 _log_update: [690] (29.1 %) of epoch 9 -- lr = 5, duration = 32.3 ms
2017-08-01 14:11:44,143 _log_update: [890] (37.5 %) of epoch 9 -- lr = 5, duration = 31.9 ms
2017-08-01 14:12:48,446 _log_update: [1090] (46.0 %) of epoch 9 -- lr = 5, duration = 32.4 ms
2017-08-01 14:13:53,587 _log_update: [1290] (54.4 %) of epoch 9 -- lr = 5, duration = 32.0 ms
2017-08-01 14:14:59,015 _log_update: [1490] (62.8 %) of epoch 9 -- lr = 5, duration = 32.7 ms
2017-08-01 14:16:04,169 _log_update: [1690] (71.3 %) of epoch 9 -- lr = 5, duration = 32.7 ms
2017-08-01 14:17:09,412 _log_update: [1890] (79.7 %) of epoch 9 -- lr = 5, duration = 32.1 ms
2017-08-01 14:18:13,742 _log_update: [2090] (88.1 %) of epoch 9 -- lr = 5, duration = 31.8 ms
2017-08-01 14:19:17,760 _log_update: [2290] (96.6 %) of epoch 9 -- lr = 5, duration = 31.7 ms
2017-08-01 14:19:45,677 _validate: [2365] First validation sample, perplexity 173.04.
2017-08-01 14:19:58,395 _validate: [2368] Center of validation, perplexity 173.60.
2017-08-01 14:20:11,367 _validate: [2371] Last validation sample, perplexity 171.36.
2017-08-01 14:20:11,367 _log_validation: [2371] Validation set cost history: 338.1 263.8 240.3 216.1 200.4 181.0 173.2 [171.8] 173.0
2017-08-01 14:20:11,368 set_state: layers/projection_layer/W <- array(10001, 100)
2017-08-01 14:20:11,369 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-08-01 14:20:11,370 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-08-01 14:20:11,370 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-08-01 14:20:11,373 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-08-01 14:20:11,373 set_state: layers/output_layer/input/b <- array(10001,)
2017-08-01 14:20:11,375 _reset_state: [2368] (99.87 %) of epoch 8
2017-08-01 14:20:11,375 _log_validation: [2368] Validation set cost history: 338.1 263.8 240.3 216.1 200.4 181.0 173.2 [171.8]
2017-08-01 14:20:11,375 set_state: Restored iterator to line 42024 of 42068.
2017-08-01 14:20:11,376 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2017-08-01 14:20:11,376 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2017-08-01 14:20:11,378 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2017-08-01 14:20:11,378 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2017-08-01 14:20:11,386 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2017-08-01 14:20:11,387 set_state: layers/output_layer/input/b_gradient <- array(10001,)
Model performance stopped improving. Decreasing learning rate from 5.0 to 2.5 and resetting state to 100 % of epoch 8.
2017-08-01 14:20:11,388 _reset: Generating a random order of input lines.
Finished training epoch 8 in 0 hours 13.2 minutes. Best validation perplexity 171.81.
2017-08-01 14:20:49,861 _log_update: [119] (5.0 %) of epoch 9 -- lr = 2, duration = 32.0 ms
2017-08-01 14:21:53,857 _log_update: [319] (13.5 %) of epoch 9 -- lr = 2, duration = 31.8 ms
2017-08-01 14:22:57,929 _log_update: [519] (21.9 %) of epoch 9 -- lr = 2, duration = 31.8 ms
2017-08-01 14:24:01,896 _log_update: [719] (30.3 %) of epoch 9 -- lr = 2, duration = 31.9 ms
2017-08-01 14:25:05,916 _log_update: [919] (38.8 %) of epoch 9 -- lr = 2, duration = 32.1 ms
2017-08-01 14:26:10,278 _log_update: [1119] (47.2 %) of epoch 9 -- lr = 2, duration = 31.6 ms
2017-08-01 14:27:14,358 _log_update: [1319] (55.6 %) of epoch 9 -- lr = 2, duration = 31.9 ms
2017-08-01 14:28:18,730 _log_update: [1519] (64.1 %) of epoch 9 -- lr = 2, duration = 31.9 ms
2017-08-01 14:29:22,800 _log_update: [1719] (72.5 %) of epoch 9 -- lr = 2, duration = 31.9 ms
2017-08-01 14:30:27,217 _log_update: [1919] (80.9 %) of epoch 9 -- lr = 2, duration = 31.8 ms
2017-08-01 14:31:31,495 _log_update: [2119] (89.4 %) of epoch 9 -- lr = 2, duration = 32.1 ms
2017-08-01 14:32:36,523 _log_update: [2319] (97.8 %) of epoch 9 -- lr = 2, duration = 33.1 ms
2017-08-01 14:32:55,416 _validate: [2365] First validation sample, perplexity 171.16.
2017-08-01 14:33:08,423 _validate: [2368] Center of validation, perplexity 170.10.
2017-08-01 14:33:21,792 _validate: [2371] Last validation sample, perplexity 168.43.
2017-08-01 14:33:21,809 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-01 14:33:21,809 _log_validation: [2371] Validation set cost history: 338.1 263.8 240.3 216.1 200.4 181.0 173.2 171.8 [169.5]
2017-08-01 14:33:21,810 _reset: Generating a random order of input lines.
Finished training epoch 9 in 0 hours 13.2 minutes. Best validation perplexity 169.47.
2017-08-01 14:34:09,843 _log_update: [148] (6.2 %) of epoch 10 -- lr = 2, duration = 32.0 ms
2017-08-01 14:35:15,010 _log_update: [348] (14.7 %) of epoch 10 -- lr = 2, duration = 31.8 ms
2017-08-01 14:36:19,885 _log_update: [548] (23.1 %) of epoch 10 -- lr = 2, duration = 32.6 ms
2017-08-01 14:37:24,703 _log_update: [748] (31.5 %) of epoch 10 -- lr = 2, duration = 32.6 ms
2017-08-01 14:38:29,416 _log_update: [948] (40.0 %) of epoch 10 -- lr = 2, duration = 32.4 ms
2017-08-01 14:39:34,080 _log_update: [1148] (48.4 %) of epoch 10 -- lr = 2, duration = 32.9 ms
2017-08-01 14:40:38,764 _log_update: [1348] (56.9 %) of epoch 10 -- lr = 2, duration = 32.2 ms
2017-08-01 14:41:43,676 _log_update: [1548] (65.3 %) of epoch 10 -- lr = 2, duration = 32.1 ms
2017-08-01 14:42:48,089 _log_update: [1748] (73.7 %) of epoch 10 -- lr = 2, duration = 32.1 ms
2017-08-01 14:43:54,486 _log_update: [1948] (82.2 %) of epoch 10 -- lr = 2, duration = 33.3 ms
2017-08-01 14:45:01,274 _log_update: [2148] (90.6 %) of epoch 10 -- lr = 2, duration = 33.4 ms
2017-08-01 14:46:08,026 _log_update: [2348] (99.0 %) of epoch 10 -- lr = 2, duration = 33.6 ms
2017-08-01 14:46:18,242 _validate: [2365] First validation sample, perplexity 169.24.
2017-08-01 14:46:32,596 _validate: [2368] Center of validation, perplexity 169.21.
2017-08-01 14:46:46,898 _validate: [2371] Last validation sample, perplexity 168.86.
2017-08-01 14:46:46,914 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-01 14:46:46,914 _log_validation: [2371] Validation set cost history: 338.1 263.8 240.3 216.1 200.4 181.0 173.2 171.8 169.5 [169.2]
2017-08-01 14:46:46,915 _reset: Generating a random order of input lines.
Finished training epoch 10 in 0 hours 13.4 minutes. Best validation perplexity 169.21.
2017-08-01 14:47:46,110 _log_update: [177] (7.5 %) of epoch 11 -- lr = 2, duration = 33.5 ms
2017-08-01 14:48:52,847 _log_update: [377] (15.9 %) of epoch 11 -- lr = 2, duration = 33.4 ms
2017-08-01 14:49:59,590 _log_update: [577] (24.3 %) of epoch 11 -- lr = 2, duration = 33.6 ms
2017-08-01 14:51:06,325 _log_update: [777] (32.8 %) of epoch 11 -- lr = 2, duration = 33.6 ms
2017-08-01 14:52:13,177 _log_update: [977] (41.2 %) of epoch 11 -- lr = 2, duration = 33.7 ms
2017-08-01 14:53:20,012 _log_update: [1177] (49.6 %) of epoch 11 -- lr = 2, duration = 33.0 ms
2017-08-01 14:54:26,769 _log_update: [1377] (58.1 %) of epoch 11 -- lr = 2, duration = 33.3 ms
2017-08-01 14:55:33,646 _log_update: [1577] (66.5 %) of epoch 11 -- lr = 2, duration = 33.8 ms
2017-08-01 14:56:40,411 _log_update: [1777] (74.9 %) of epoch 11 -- lr = 2, duration = 33.0 ms
2017-08-01 14:57:47,268 _log_update: [1977] (83.4 %) of epoch 11 -- lr = 2, duration = 33.4 ms
2017-08-01 14:58:54,163 _log_update: [2177] (91.8 %) of epoch 11 -- lr = 2, duration = 33.5 ms
2017-08-01 15:00:01,476 _validate: [2365] First validation sample, perplexity 169.07.
2017-08-01 15:00:16,019 _validate: [2368] Center of validation, perplexity 169.52.
2017-08-01 15:00:29,731 _validate: [2371] Last validation sample, perplexity 167.76.
2017-08-01 15:00:29,732 _log_validation: [2371] Validation set cost history: 338.1 263.8 240.3 216.1 200.4 181.0 173.2 171.8 169.5 [169.2] 169.1
2017-08-01 15:00:29,733 set_state: layers/projection_layer/W <- array(10001, 100)
2017-08-01 15:00:29,734 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-08-01 15:00:29,734 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-08-01 15:00:29,735 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-08-01 15:00:29,738 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-08-01 15:00:29,738 set_state: layers/output_layer/input/b <- array(10001,)
2017-08-01 15:00:29,739 _reset_state: [2368] (99.87 %) of epoch 10
2017-08-01 15:00:29,740 _log_validation: [2368] Validation set cost history: 338.1 263.8 240.3 216.1 200.4 181.0 173.2 171.8 169.5 [169.2]
2017-08-01 15:00:29,740 set_state: Restored iterator to line 42026 of 42068.
2017-08-01 15:00:29,741 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2017-08-01 15:00:29,741 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2017-08-01 15:00:29,742 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2017-08-01 15:00:29,743 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2017-08-01 15:00:29,750 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2017-08-01 15:00:29,751 set_state: layers/output_layer/input/b_gradient <- array(10001,)
Model performance stopped improving. Decreasing learning rate from 2.5 to 1.25 and resetting state to 100 % of epoch 10.
2017-08-01 15:00:29,752 _reset: Generating a random order of input lines.
Finished training epoch 10 in 0 hours 13.7 minutes. Best validation perplexity 169.21.
2017-08-01 15:00:31,711 _log_update: [6] (0.3 %) of epoch 11 -- lr = 1, duration = 32.7 ms
2017-08-01 15:01:36,678 _log_update: [206] (8.7 %) of epoch 11 -- lr = 1, duration = 33.5 ms
2017-08-01 15:02:43,785 _log_update: [406] (17.1 %) of epoch 11 -- lr = 1, duration = 33.3 ms
2017-08-01 15:03:50,802 _log_update: [606] (25.6 %) of epoch 11 -- lr = 1, duration = 33.4 ms
2017-08-01 15:04:57,595 _log_update: [806] (34.0 %) of epoch 11 -- lr = 1, duration = 33.1 ms
2017-08-01 15:06:04,355 _log_update: [1006] (42.4 %) of epoch 11 -- lr = 1, duration = 33.6 ms
2017-08-01 15:07:10,970 _log_update: [1206] (50.9 %) of epoch 11 -- lr = 1, duration = 33.7 ms
2017-08-01 15:08:18,131 _log_update: [1406] (59.3 %) of epoch 11 -- lr = 1, duration = 33.6 ms
2017-08-01 15:09:23,248 _log_update: [1606] (67.7 %) of epoch 11 -- lr = 1, duration = 32.2 ms
2017-08-01 15:10:28,479 _log_update: [1806] (76.2 %) of epoch 11 -- lr = 1, duration = 32.2 ms
2017-08-01 15:11:33,387 _log_update: [2006] (84.6 %) of epoch 11 -- lr = 1, duration = 32.0 ms
2017-08-01 15:12:38,189 _log_update: [2206] (93.0 %) of epoch 11 -- lr = 1, duration = 32.3 ms
2017-08-01 15:13:33,945 _validate: [2365] First validation sample, perplexity 169.33.
2017-08-01 15:13:46,745 _validate: [2368] Center of validation, perplexity 168.16.
2017-08-01 15:13:59,820 _validate: [2371] Last validation sample, perplexity 167.97.
2017-08-01 15:13:59,839 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-01 15:13:59,840 _log_validation: [2371] Validation set cost history: 338.1 263.8 240.3 216.1 200.4 181.0 173.2 171.8 169.5 169.2 [168.2]
2017-08-01 15:13:59,841 _reset: Generating a random order of input lines.
Finished training epoch 11 in 0 hours 13.5 minutes. Best validation perplexity 168.21.
2017-08-01 15:14:11,233 _log_update: [35] (1.5 %) of epoch 12 -- lr = 1, duration = 32.8 ms
2017-08-01 15:15:15,636 _log_update: [235] (9.9 %) of epoch 12 -- lr = 1, duration = 32.3 ms
2017-08-01 15:16:20,682 _log_update: [435] (18.3 %) of epoch 12 -- lr = 1, duration = 32.0 ms
2017-08-01 15:17:25,599 _log_update: [635] (26.8 %) of epoch 12 -- lr = 1, duration = 31.7 ms
2017-08-01 15:18:30,443 _log_update: [835] (35.2 %) of epoch 12 -- lr = 1, duration = 32.0 ms
2017-08-01 15:19:34,976 _log_update: [1035] (43.7 %) of epoch 12 -- lr = 1, duration = 31.8 ms
2017-08-01 15:20:39,482 _log_update: [1235] (52.1 %) of epoch 12 -- lr = 1, duration = 32.1 ms
2017-08-01 15:21:44,314 _log_update: [1435] (60.5 %) of epoch 12 -- lr = 1, duration = 33.1 ms
2017-08-01 15:22:49,138 _log_update: [1635] (69.0 %) of epoch 12 -- lr = 1, duration = 32.2 ms
2017-08-01 15:23:54,231 _log_update: [1835] (77.4 %) of epoch 12 -- lr = 1, duration = 32.0 ms
2017-08-01 15:24:59,134 _log_update: [2035] (85.8 %) of epoch 12 -- lr = 1, duration = 32.3 ms
2017-08-01 15:26:03,850 _log_update: [2235] (94.3 %) of epoch 12 -- lr = 1, duration = 32.0 ms
2017-08-01 15:26:50,017 _validate: [2365] First validation sample, perplexity 168.42.
2017-08-01 15:27:02,879 _validate: [2368] Center of validation, perplexity 168.26.
2017-08-01 15:27:15,574 _validate: [2371] Last validation sample, perplexity 168.61.
2017-08-01 15:27:15,574 _log_validation: [2371] Validation set cost history: 338.1 263.8 240.3 216.1 200.4 181.0 173.2 171.8 169.5 169.2 [168.2] 168.3
2017-08-01 15:27:15,576 set_state: layers/projection_layer/W <- array(10001, 100)
2017-08-01 15:27:15,577 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-08-01 15:27:15,577 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-08-01 15:27:15,578 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-08-01 15:27:15,581 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-08-01 15:27:15,582 set_state: layers/output_layer/input/b <- array(10001,)
2017-08-01 15:27:15,583 _reset_state: [2368] (99.87 %) of epoch 11
2017-08-01 15:27:15,583 _log_validation: [2368] Validation set cost history: 338.1 263.8 240.3 216.1 200.4 181.0 173.2 171.8 169.5 169.2 [168.2]
2017-08-01 15:27:15,584 set_state: Restored iterator to line 42022 of 42068.
2017-08-01 15:27:15,584 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2017-08-01 15:27:15,585 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2017-08-01 15:27:15,586 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2017-08-01 15:27:15,587 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2017-08-01 15:27:15,594 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2017-08-01 15:27:15,595 set_state: layers/output_layer/input/b_gradient <- array(10001,)
Model performance stopped improving. Decreasing learning rate from 1.25 to 0.625 and resetting state to 100 % of epoch 11.
2017-08-01 15:27:15,596 _reset: Generating a random order of input lines.
Finished training epoch 11 in 0 hours 13.3 minutes. Best validation perplexity 168.21.
2017-08-01 15:27:36,416 _log_update: [64] (2.7 %) of epoch 12 -- lr = 0.6, duration = 32.6 ms
2017-08-01 15:28:41,181 _log_update: [264] (11.1 %) of epoch 12 -- lr = 0.6, duration = 32.6 ms
2017-08-01 15:29:45,686 _log_update: [464] (19.6 %) of epoch 12 -- lr = 0.6, duration = 33.1 ms
2017-08-01 15:30:50,729 _log_update: [664] (28.0 %) of epoch 12 -- lr = 0.6, duration = 33.9 ms
2017-08-01 15:31:55,606 _log_update: [864] (36.4 %) of epoch 12 -- lr = 0.6, duration = 32.0 ms
2017-08-01 15:33:00,247 _log_update: [1064] (44.9 %) of epoch 12 -- lr = 0.6, duration = 32.0 ms
2017-08-01 15:34:05,551 _log_update: [1264] (53.3 %) of epoch 12 -- lr = 0.6, duration = 33.6 ms
2017-08-01 15:35:10,671 _log_update: [1464] (61.7 %) of epoch 12 -- lr = 0.6, duration = 33.2 ms
2017-08-01 15:36:15,195 _log_update: [1664] (70.2 %) of epoch 12 -- lr = 0.6, duration = 32.5 ms
2017-08-01 15:37:19,910 _log_update: [1864] (78.6 %) of epoch 12 -- lr = 0.6, duration = 32.2 ms
2017-08-01 15:38:24,473 _log_update: [2064] (87.1 %) of epoch 12 -- lr = 0.6, duration = 32.4 ms
2017-08-01 15:39:29,487 _log_update: [2264] (95.5 %) of epoch 12 -- lr = 0.6, duration = 34.5 ms
2017-08-01 15:40:06,563 _validate: [2365] First validation sample, perplexity 168.02.
2017-08-01 15:40:19,650 _validate: [2368] Center of validation, perplexity 167.84.
2017-08-01 15:40:32,842 _validate: [2371] Last validation sample, perplexity 167.94.
2017-08-01 15:40:32,858 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-01 15:40:32,858 _log_validation: [2371] Validation set cost history: 338.1 263.8 240.3 216.1 200.4 181.0 173.2 171.8 169.5 169.2 168.2 [167.9]
2017-08-01 15:40:32,859 _reset: Generating a random order of input lines.
Finished training epoch 12 in 0 hours 13.3 minutes. Best validation perplexity 167.93.
2017-08-01 15:41:02,990 _log_update: [93] (3.9 %) of epoch 13 -- lr = 0.6, duration = 32.4 ms
2017-08-01 15:42:07,679 _log_update: [293] (12.4 %) of epoch 13 -- lr = 0.6, duration = 32.9 ms
2017-08-01 15:43:12,516 _log_update: [493] (20.8 %) of epoch 13 -- lr = 0.6, duration = 33.1 ms
2017-08-01 15:44:17,278 _log_update: [693] (29.2 %) of epoch 13 -- lr = 0.6, duration = 31.9 ms
2017-08-01 15:45:22,037 _log_update: [893] (37.7 %) of epoch 13 -- lr = 0.6, duration = 32.8 ms
2017-08-01 15:46:26,856 _log_update: [1093] (46.1 %) of epoch 13 -- lr = 0.6, duration = 32.1 ms
2017-08-01 15:47:31,626 _log_update: [1293] (54.5 %) of epoch 13 -- lr = 0.6, duration = 32.1 ms
2017-08-01 15:48:36,684 _log_update: [1493] (63.0 %) of epoch 13 -- lr = 0.6, duration = 31.8 ms
2017-08-01 15:49:41,309 _log_update: [1693] (71.4 %) of epoch 13 -- lr = 0.6, duration = 32.7 ms
2017-08-01 15:50:46,432 _log_update: [1893] (79.8 %) of epoch 13 -- lr = 0.6, duration = 32.8 ms
2017-08-01 15:51:51,287 _log_update: [2093] (88.3 %) of epoch 13 -- lr = 0.6, duration = 32.0 ms
2017-08-01 15:52:55,668 _log_update: [2293] (96.7 %) of epoch 13 -- lr = 0.6, duration = 32.0 ms
2017-08-01 15:53:23,074 _validate: [2365] First validation sample, perplexity 167.14.
2017-08-01 15:53:35,956 _validate: [2368] Center of validation, perplexity 167.11.
2017-08-01 15:53:48,637 _validate: [2371] Last validation sample, perplexity 167.03.
2017-08-01 15:53:48,653 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2017-08-01 15:53:48,653 _log_validation: [2371] Validation set cost history: 338.1 263.8 240.3 216.1 200.4 181.0 173.2 171.8 169.5 169.2 168.2 167.9 [167.1]
2017-08-01 15:53:48,654 _reset: Generating a random order of input lines.
Finished training epoch 13 in 0 hours 13.3 minutes. Best validation perplexity 167.11.
2017-08-01 15:54:27,834 _log_update: [122] (5.1 %) of epoch 14 -- lr = 0.6, duration = 32.0 ms
2017-08-01 15:55:32,014 _log_update: [322] (13.6 %) of epoch 14 -- lr = 0.6, duration = 32.4 ms
2017-08-01 15:56:36,639 _log_update: [522] (22.0 %) of epoch 14 -- lr = 0.6, duration = 32.0 ms
2017-08-01 15:57:40,979 _log_update: [722] (30.5 %) of epoch 14 -- lr = 0.6, duration = 33.4 ms
2017-08-01 15:58:45,072 _log_update: [922] (38.9 %) of epoch 14 -- lr = 0.6, duration = 31.9 ms
2017-08-01 15:59:49,472 _log_update: [1122] (47.3 %) of epoch 14 -- lr = 0.6, duration = 33.5 ms
2017-08-01 16:00:54,030 _log_update: [1322] (55.8 %) of epoch 14 -- lr = 0.6, duration = 32.4 ms
2017-08-01 16:01:59,104 _log_update: [1522] (64.2 %) of epoch 14 -- lr = 0.6, duration = 32.0 ms
2017-08-01 16:03:03,424 _log_update: [1722] (72.6 %) of epoch 14 -- lr = 0.6, duration = 32.0 ms
2017-08-01 16:04:09,454 _log_update: [1922] (81.1 %) of epoch 14 -- lr = 0.6, duration = 33.2 ms
2017-08-01 16:05:14,224 _log_update: [2122] (89.5 %) of epoch 14 -- lr = 0.6, duration = 32.1 ms
2017-08-01 16:06:19,539 _log_update: [2322] (97.9 %) of epoch 14 -- lr = 0.6, duration = 31.9 ms
2017-08-01 16:06:37,206 _validate: [2365] First validation sample, perplexity 167.87.
2017-08-01 16:06:49,734 _validate: [2368] Center of validation, perplexity 167.94.
2017-08-01 16:07:02,311 _validate: [2371] Last validation sample, perplexity 167.94.
2017-08-01 16:07:02,311 _log_validation: [2371] Validation set cost history: 338.1 263.8 240.3 216.1 200.4 181.0 173.2 171.8 169.5 169.2 168.2 167.9 [167.1] 167.9
2017-08-01 16:07:02,313 set_state: layers/projection_layer/W <- array(10001, 100)
2017-08-01 16:07:02,313 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-08-01 16:07:02,314 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-08-01 16:07:02,314 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-08-01 16:07:02,317 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-08-01 16:07:02,318 set_state: layers/output_layer/input/b <- array(10001,)
2017-08-01 16:07:02,319 _reset_state: [2368] (99.87 %) of epoch 13
2017-08-01 16:07:02,320 _log_validation: [2368] Validation set cost history: 338.1 263.8 240.3 216.1 200.4 181.0 173.2 171.8 169.5 169.2 168.2 167.9 [167.1]
2017-08-01 16:07:02,320 set_state: Restored iterator to line 42022 of 42068.
2017-08-01 16:07:02,321 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2017-08-01 16:07:02,321 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2017-08-01 16:07:02,322 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2017-08-01 16:07:02,323 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2017-08-01 16:07:02,331 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2017-08-01 16:07:02,332 set_state: layers/output_layer/input/b_gradient <- array(10001,)
Model performance stopped improving. Decreasing learning rate from 0.625 to 0.3125 and resetting state to 100 % of epoch 13.
2017-08-01 16:07:02,333 _reset: Generating a random order of input lines.
Finished training epoch 13 in 0 hours 13.2 minutes. Best validation perplexity 167.11.
2017-08-01 16:07:51,574 _log_update: [151] (6.4 %) of epoch 14 -- lr = 0.3, duration = 35.7 ms
2017-08-01 16:08:57,667 _log_update: [351] (14.8 %) of epoch 14 -- lr = 0.3, duration = 32.4 ms
2017-08-01 16:10:03,358 _log_update: [551] (23.2 %) of epoch 14 -- lr = 0.3, duration = 32.7 ms
2017-08-01 16:11:08,647 _log_update: [751] (31.7 %) of epoch 14 -- lr = 0.3, duration = 31.9 ms
2017-08-01 16:12:14,079 _log_update: [951] (40.1 %) of epoch 14 -- lr = 0.3, duration = 31.9 ms
2017-08-01 16:13:18,093 _log_update: [1151] (48.5 %) of epoch 14 -- lr = 0.3, duration = 32.0 ms
2017-08-01 16:14:22,770 _log_update: [1351] (57.0 %) of epoch 14 -- lr = 0.3, duration = 32.0 ms
2017-08-01 16:15:26,997 _log_update: [1551] (65.4 %) of epoch 14 -- lr = 0.3, duration = 34.5 ms
2017-08-01 16:16:33,361 _log_update: [1751] (73.9 %) of epoch 14 -- lr = 0.3, duration = 31.8 ms
2017-08-01 16:17:39,622 _log_update: [1951] (82.3 %) of epoch 14 -- lr = 0.3, duration = 36.7 ms
2017-08-01 16:18:44,775 _log_update: [2151] (90.7 %) of epoch 14 -- lr = 0.3, duration = 31.9 ms
2017-08-01 16:19:49,584 _log_update: [2351] (99.2 %) of epoch 14 -- lr = 0.3, duration = 32.3 ms
2017-08-01 16:19:57,985 _validate: [2365] First validation sample, perplexity 167.96.
2017-08-01 16:20:10,571 _validate: [2368] Center of validation, perplexity 167.77.
2017-08-01 16:20:24,365 _validate: [2371] Last validation sample, perplexity 167.70.
2017-08-01 16:20:24,366 _log_validation: [2371] Validation set cost history: 338.1 263.8 240.3 216.1 200.4 181.0 173.2 171.8 169.5 169.2 168.2 167.9 [167.1] 167.8
2017-08-01 16:20:24,367 set_state: layers/projection_layer/W <- array(10001, 100)
2017-08-01 16:20:24,368 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-08-01 16:20:24,368 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-08-01 16:20:24,369 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-08-01 16:20:24,372 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-08-01 16:20:24,372 set_state: layers/output_layer/input/b <- array(10001,)
2017-08-01 16:20:24,373 _reset_state: [2368] (99.87 %) of epoch 13
2017-08-01 16:20:24,374 _log_validation: [2368] Validation set cost history: 338.1 263.8 240.3 216.1 200.4 181.0 173.2 171.8 169.5 169.2 168.2 167.9 [167.1]
2017-08-01 16:20:24,374 set_state: Restored iterator to line 42022 of 42068.
2017-08-01 16:20:24,375 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2017-08-01 16:20:24,375 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2017-08-01 16:20:24,377 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2017-08-01 16:20:24,377 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2017-08-01 16:20:24,385 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2017-08-01 16:20:24,385 set_state: layers/output_layer/input/b_gradient <- array(10001,)
Model performance stopped improving. Decreasing learning rate from 0.3125 to 0.15625 and resetting state to 100 % of epoch 13.
Finished training epoch 13 in 0 hours 13.4 minutes. Best validation perplexity 167.11.
Training finished in 4 hours 24.4 minutes.
2017-08-01 16:20:24,388 set_state: layers/projection_layer/W <- array(10001, 100)
2017-08-01 16:20:24,389 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2017-08-01 16:20:24,389 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2017-08-01 16:20:24,390 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2017-08-01 16:20:24,393 set_state: layers/output_layer/input/W <- array(256, 10001)
2017-08-01 16:20:24,394 set_state: layers/output_layer/input/b <- array(10001,)
Best validation set perplexity: 167.110317853
train finished.
Computing evaluation set perplexity.
Reading vocabulary from network state.
Number of words in vocabulary: 10001
Number of words in shortlist: 10001
Number of word classes: 10001
Building neural network.
Restoring neural network state.
Building text scorer.
Number of sentences: 3761
Number of words: 86191
Number of tokens: 86191
Number of predicted probabilities: 82430
Number of excluded (OOV) words: 0
Number of zero probabilities: 0
Cross entropy (base e): 4.928060560856173
Perplexity: 138.1113937808815
